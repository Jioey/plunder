Relevant data:
        x(t-1)  y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0      185.700   4.041   104.386     -5.073    59.571     -2.941    81.418   
1      190.839   4.068   103.280     -6.411    58.972     -3.216    80.759   
2      196.025   4.035   101.907     -7.773    58.302     -3.796    16.904   
3      201.283   4.100   100.307     -8.468    57.539     -3.980    15.434   
4      206.598   4.101    98.542     -9.653    56.700     -4.828    13.955   
...        ...     ...       ...        ...       ...        ...       ...   
3955  1078.384  15.502    11.692     -3.967    26.947     -4.112    13.404   
3956  1083.396  15.562    10.953     -3.204    26.179     -3.348    12.372   
3957  1088.222  15.580    10.400     -2.246    25.598     -2.389    11.528   
3958  1092.896  15.640    10.000     -1.458    25.169     -1.601    10.838   
3959  1097.448  15.747     9.721     -1.145    24.861     -1.286    10.270   

      r_vx(t-1)  HA(t-1)  controller-LA.steer-0(t-1)  \
0        -3.233      0.0               -3.346666e-03   
1        -3.517      0.0               -4.506665e-03   
2        -7.572      0.0                3.933334e-03   
3        -7.360      0.0               -4.933328e-03   
4        -7.881      0.0               -3.746662e-03   
...         ...      ...                         ...   
3955     -5.430      1.0                2.393902e-04   
3956     -4.661      1.0               -5.604149e-04   
3957     -3.698      1.0                2.399634e-03   
3958     -2.905      1.0               -2.303801e-07   
3959     -2.586      1.0               -8.226747e-03   

      controller-LA.steer-1(t-1)  controller-LA.steer-2(t-1)  \
0                  -3.346666e-03                     -0.0828   
1                  -4.506665e-03                     -0.0836   
2                   3.933334e-03                     -0.0756   
3                  -4.933328e-03                     -0.0836   
4                  -3.746662e-03                     -0.0824   
...                          ...                         ...   
3955                2.393902e-04                     -0.0864   
3956               -5.604149e-04                     -0.0864   
3957                2.399634e-03                     -0.0832   
3958               -2.303801e-07                     -0.0848   
3959               -8.226747e-03                     -0.0916   

      controller-LA.steer-3(t-1)  controller-LA.acc-0(t-1)  \
0                         0.0772                    1.7256   
1                         0.0764                    1.6648   
2                         0.0844                    1.4764   
3                         0.0764                    1.4424   
4                         0.0776                    1.1388   
...                          ...                       ...   
3955                      0.0736                    1.8664   
3956                      0.0736                    2.1716   
3957                      0.0768                    2.5548   
3958                      0.0752                    2.8700   
3959                      0.0684                    2.9952   

      controller-LA.acc-1(t-1)  controller-LA.acc-2(t-1)  \
0                      -3.8744                       0.0   
1                      -3.9352                       0.0   
2                      -4.1236                       0.0   
3                      -4.1576                       0.0   
4                      -4.4612                       0.0   
...                        ...                       ...   
3955                   -3.7336                       0.0   
3956                   -3.4284                       0.0   
3957                   -3.0452                       0.0   
3958                   -2.7300                       0.0   
3959                   -2.6048                       0.0   

      controller-LA.acc-3(t-1)  LA.steer(t-1)  LA.acc(t-1)      x(t)    y(t)  \
0                          0.0          0.002        1.949   190.839   4.068   
1                          0.0          0.001       -0.329   196.025   4.035   
2                          0.0          0.013        0.273   201.283   4.100   
3                          0.0         -0.063        0.047   206.598   4.101   
4                          0.0          0.007        1.553   212.066   4.040   
...                        ...            ...          ...       ...     ...   
3955                       0.0          0.010       -5.819  1083.396  15.562   
3956                       0.0          0.052      -10.510  1088.222  15.580   
3957                       0.0          0.000       -4.862  1092.896  15.640   
3958                       0.0         -0.022       -4.430  1097.448  15.747   
3959                       0.0         -0.018       -6.062  1101.874  15.796   

       l_x(t)  l_vx(t)  f_x(t)  f_vx(t)  r_x(t)  r_vx(t)  HA(t)  \
0     103.280   -6.411  58.972   -3.216  80.759   -3.517      0   
1     101.907   -7.773  58.302   -3.796  16.904   -7.572      0   
2     100.307   -8.468  57.539   -3.980  15.434   -7.360      0   
3      98.542   -9.653  56.700   -4.828  13.955   -7.881      0   
4      96.550  -10.324  55.690   -5.281  12.361   -8.070      0   
...       ...      ...     ...      ...     ...      ...    ...   
3955   10.953   -3.204  26.179   -3.348  12.372   -4.661      1   
3956   10.400   -2.246  25.598   -2.389  11.528   -3.698      1   
3957   10.000   -1.458  25.169   -1.601  10.838   -2.905      1   
3958    9.721   -1.145  24.861   -1.286  10.270   -2.586      1   
3959    9.569   -0.124  24.681   -0.264   9.830   -1.559      1   

      controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0                -4.506665e-03             -4.506665e-03   
1                 3.933334e-03              3.933334e-03   
2                -4.933328e-03             -4.933328e-03   
3                -3.746662e-03             -3.746662e-03   
4                 5.066667e-03              5.066667e-03   
...                        ...                       ...   
3955             -5.604149e-04             -5.604149e-04   
3956              2.399634e-03              2.399634e-03   
3957             -2.303801e-07             -2.303801e-07   
3958             -8.226747e-03             -8.226747e-03   
3959             -2.480042e-03             -2.480042e-03   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  \
0                      -0.0836                    0.0764   
1                      -0.0756                    0.0844   
2                      -0.0836                    0.0764   
3                      -0.0824                    0.0776   
4                      -0.0744                    0.0856   
...                        ...                       ...   
3955                   -0.0864                    0.0736   
3956                   -0.0832                    0.0768   
3957                   -0.0848                    0.0752   
3958                   -0.0916                    0.0684   
3959                   -0.0852                    0.0748   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                     1.6648                 -3.9352                     0.0   
1                     1.4764                 -4.1236                     0.0   
2                     1.4424                 -4.1576                     0.0   
3                     1.1388                 -4.4612                     0.0   
4                     0.9900                 -4.6100                     0.0   
...                      ...                     ...                     ...   
3955                  2.1716                 -3.4284                     0.0   
3956                  2.5548                 -3.0452                     0.0   
3957                  2.8700                 -2.7300                     0.0   
3958                  2.9952                 -2.6048                     0.0   
3959                  3.4036                 -2.1964                     0.0   

      controller-LA.acc-3(t)  LA.steer(t)  LA.acc(t)  
0                        0.0        0.001     -0.329  
1                        0.0        0.013      0.273  
2                        0.0       -0.063      0.047  
3                        0.0        0.007      1.553  
4                        0.0        0.024     -1.334  
...                      ...          ...        ...  
3955                     0.0        0.052    -10.510  
3956                     0.0        0.000     -4.862  
3957                     0.0       -0.022     -4.430  
3958                     0.0       -0.018     -6.062  
3959                     0.0       -0.036     -6.601  

[3960 rows x 38 columns]


Relevant data: Scaled and reframed as a supervised learning problem


        x(t-1)    y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     0.052657  0.186230  0.638499   0.176367  0.305256   0.520222  0.457912   
1     0.056866  0.187125  0.632324   0.146183  0.301863   0.505834  0.454610   
2     0.061113  0.186031  0.624657   0.115457  0.298069   0.475488  0.134666   
3     0.065419  0.188186  0.615723   0.099779  0.293748   0.465861  0.127301   
4     0.069771  0.188219  0.605868   0.073046  0.288996   0.421493  0.119891   
...        ...       ...       ...        ...       ...        ...       ...   
3955  0.783703  0.566148  0.120930   0.201317  0.120490   0.458955  0.117130   
3956  0.787807  0.568137  0.116804   0.218530  0.116141   0.498927  0.111959   
3957  0.791759  0.568734  0.113716   0.240142  0.112850   0.549103  0.107730   
3958  0.795587  0.570723  0.111483   0.257918  0.110421   0.590331  0.104273   
3959  0.799315  0.574270  0.109925   0.264979  0.108676   0.606812  0.101427   

      r_vx(t-1)  HA(t-1)  controller-LA.steer-0(t-1)  \
0      0.219761      0.0                    0.494422   
1      0.213297      0.0                    0.492489   
2      0.121000      0.0                    0.506556   
3      0.125825      0.0                    0.491778   
4      0.113966      0.0                    0.493756   
...         ...      ...                         ...   
3955   0.169755      1.0                    0.500399   
3956   0.187258      1.0                    0.499066   
3957   0.209177      1.0                    0.503999   
3958   0.227227      1.0                    0.500000   
3959   0.234488      1.0                    0.486289   

      controller-LA.steer-1(t-1)  controller-LA.steer-2(t-1)  \
0                       0.494422                    0.362000   
1                       0.492489                    0.360667   
2                       0.506556                    0.374000   
3                       0.491778                    0.360667   
4                       0.493756                    0.362667   
...                          ...                         ...   
3955                    0.500399                    0.356000   
3956                    0.499066                    0.356000   
3957                    0.503999                    0.361333   
3958                    0.500000                    0.358667   
3959                    0.486289                    0.347333   

      controller-LA.steer-3(t-1)  controller-LA.acc-0(t-1)  \
0                       0.628667                  0.571900   
1                       0.627333                  0.569367   
2                       0.640667                  0.561517   
3                       0.627333                  0.560100   
4                       0.629333                  0.547450   
...                          ...                       ...   
3955                    0.622667                  0.577767   
3956                    0.622667                  0.590483   
3957                    0.628000                  0.606450   
3958                    0.625333                  0.619583   
3959                    0.614000                  0.624800   

      controller-LA.acc-1(t-1)  controller-LA.acc-2(t-1)  \
0                     0.338567                       0.5   
1                     0.336033                       0.5   
2                     0.328183                       0.5   
3                     0.326767                       0.5   
4                     0.314117                       0.5   
...                        ...                       ...   
3955                  0.344433                       0.5   
3956                  0.357150                       0.5   
3957                  0.373117                       0.5   
3958                  0.386250                       0.5   
3959                  0.391467                       0.5   

      controller-LA.acc-3(t-1)  LA.steer(t-1)  LA.acc(t-1)      x(t)  \
0                          0.5       0.503333     0.581208  0.052759   
1                          0.5       0.501667     0.486292  0.057003   
2                          0.5       0.521667     0.511375  0.061306   
3                          0.5       0.395000     0.501958  0.065655   
4                          0.5       0.511667     0.564708  0.070130   
...                        ...            ...          ...       ...   
3955                       0.5       0.516667     0.257542  0.783166   
3956                       0.5       0.586667     0.062083  0.787115   
3957                       0.5       0.500000     0.297417  0.790940   
3958                       0.5       0.463333     0.315417  0.794665   
3959                       0.5       0.470000     0.247417  0.798287   

          y(t)    l_x(t)   l_vx(t)    f_x(t)   f_vx(t)    r_x(t)   r_vx(t)  \
0     0.187125  0.635860  0.146183  0.303747  0.505834  0.456504  0.213297   
1     0.186031  0.628151  0.115457  0.299929  0.475488  0.135227  0.121000   
2     0.188186  0.619167  0.099779  0.295581  0.465861  0.127831  0.125825   
3     0.188219  0.609257  0.073046  0.290799  0.421493  0.120390  0.113966   
4     0.186197  0.598072  0.057909  0.285043  0.397792  0.112370  0.109664   
...        ...       ...       ...       ...       ...       ...       ...   
3955  0.568137  0.117457  0.218530  0.116866  0.498927  0.112425  0.187258   
3956  0.568734  0.114352  0.240142  0.113555  0.549103  0.108179  0.209177   
3957  0.570723  0.112106  0.257918  0.111110  0.590331  0.104707  0.227227   
3958  0.574270  0.110540  0.264979  0.109355  0.606812  0.101850  0.234488   
3959  0.575894  0.109686  0.288012  0.108329  0.660284  0.099636  0.257864   

      HA(t)  controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0         0                  0.492489                  0.492489   
1         0                  0.506556                  0.506556   
2         0                  0.491778                  0.491778   
3         0                  0.493756                  0.493756   
4         0                  0.508444                  0.508444   
...     ...                       ...                       ...   
3955      1                  0.499066                  0.499066   
3956      1                  0.503999                  0.503999   
3957      1                  0.500000                  0.500000   
3958      1                  0.486289                  0.486289   
3959      1                  0.495867                  0.495867   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  \
0                     0.360667                  0.627333   
1                     0.374000                  0.640667   
2                     0.360667                  0.627333   
3                     0.362667                  0.629333   
4                     0.376000                  0.642667   
...                        ...                       ...   
3955                  0.356000                  0.622667   
3956                  0.361333                  0.628000   
3957                  0.358667                  0.625333   
3958                  0.347333                  0.614000   
3959                  0.358000                  0.624667   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                   0.569367                0.336033                     0.5   
1                   0.561517                0.328183                     0.5   
2                   0.560100                0.326767                     0.5   
3                   0.547450                0.314117                     0.5   
4                   0.541250                0.307917                     0.5   
...                      ...                     ...                     ...   
3955                0.590483                0.357150                     0.5   
3956                0.606450                0.373117                     0.5   
3957                0.619583                0.386250                     0.5   
3958                0.624800                0.391467                     0.5   
3959                0.641817                0.408483                     0.5   

      controller-LA.acc-3(t)  LA.steer(t)  LA.acc(t)  
0                        0.5     0.501667   0.486292  
1                        0.5     0.521667   0.511375  
2                        0.5     0.395000   0.501958  
3                        0.5     0.511667   0.564708  
4                        0.5     0.540000   0.444417  
...                      ...          ...        ...  
3955                     0.5     0.586667   0.062083  
3956                     0.5     0.500000   0.297417  
3957                     0.5     0.463333   0.315417  
3958                     0.5     0.470000   0.247417  
3959                     0.5     0.440000   0.224958  

[3960 rows x 38 columns]
        x(t-1)    y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     0.052657  0.186230  0.638499   0.176367  0.305256   0.520222  0.457912   
1     0.056866  0.187125  0.632324   0.146183  0.301863   0.505834  0.454610   
2     0.061113  0.186031  0.624657   0.115457  0.298069   0.475488  0.134666   
3     0.065419  0.188186  0.615723   0.099779  0.293748   0.465861  0.127301   
4     0.069771  0.188219  0.605868   0.073046  0.288996   0.421493  0.119891   
...        ...       ...       ...        ...       ...        ...       ...   
3955  0.783703  0.566148  0.120930   0.201317  0.120490   0.458955  0.117130   
3956  0.787807  0.568137  0.116804   0.218530  0.116141   0.498927  0.111959   
3957  0.791759  0.568734  0.113716   0.240142  0.112850   0.549103  0.107730   
3958  0.795587  0.570723  0.111483   0.257918  0.110421   0.590331  0.104273   
3959  0.799315  0.574270  0.109925   0.264979  0.108676   0.606812  0.101427   

      r_vx(t-1)  controller-LA.steer-0(t-1)  controller-LA.steer-1(t-1)  \
0      0.219761                    0.494422                    0.494422   
1      0.213297                    0.492489                    0.492489   
2      0.121000                    0.506556                    0.506556   
3      0.125825                    0.491778                    0.491778   
4      0.113966                    0.493756                    0.493756   
...         ...                         ...                         ...   
3955   0.169755                    0.500399                    0.500399   
3956   0.187258                    0.499066                    0.499066   
3957   0.209177                    0.503999                    0.503999   
3958   0.227227                    0.500000                    0.500000   
3959   0.234488                    0.486289                    0.486289   

      controller-LA.steer-2(t-1)  controller-LA.steer-3(t-1)  \
0                       0.362000                    0.628667   
1                       0.360667                    0.627333   
2                       0.374000                    0.640667   
3                       0.360667                    0.627333   
4                       0.362667                    0.629333   
...                          ...                         ...   
3955                    0.356000                    0.622667   
3956                    0.356000                    0.622667   
3957                    0.361333                    0.628000   
3958                    0.358667                    0.625333   
3959                    0.347333                    0.614000   

      controller-LA.acc-0(t-1)  controller-LA.acc-1(t-1)  \
0                     0.571900                  0.338567   
1                     0.569367                  0.336033   
2                     0.561517                  0.328183   
3                     0.560100                  0.326767   
4                     0.547450                  0.314117   
...                        ...                       ...   
3955                  0.577767                  0.344433   
3956                  0.590483                  0.357150   
3957                  0.606450                  0.373117   
3958                  0.619583                  0.386250   
3959                  0.624800                  0.391467   

      controller-LA.acc-2(t-1)  controller-LA.acc-3(t-1)  LA.steer(t-1)  \
0                          0.5                       0.5       0.503333   
1                          0.5                       0.5       0.501667   
2                          0.5                       0.5       0.521667   
3                          0.5                       0.5       0.395000   
4                          0.5                       0.5       0.511667   
...                        ...                       ...            ...   
3955                       0.5                       0.5       0.516667   
3956                       0.5                       0.5       0.586667   
3957                       0.5                       0.5       0.500000   
3958                       0.5                       0.5       0.463333   
3959                       0.5                       0.5       0.470000   

      LA.acc(t-1)      x(t)      y(t)    l_x(t)   l_vx(t)    f_x(t)   f_vx(t)  \
0        0.581208  0.052759  0.187125  0.635860  0.146183  0.303747  0.505834   
1        0.486292  0.057003  0.186031  0.628151  0.115457  0.299929  0.475488   
2        0.511375  0.061306  0.188186  0.619167  0.099779  0.295581  0.465861   
3        0.501958  0.065655  0.188219  0.609257  0.073046  0.290799  0.421493   
4        0.564708  0.070130  0.186197  0.598072  0.057909  0.285043  0.397792   
...           ...       ...       ...       ...       ...       ...       ...   
3955     0.257542  0.783166  0.568137  0.117457  0.218530  0.116866  0.498927   
3956     0.062083  0.787115  0.568734  0.114352  0.240142  0.113555  0.549103   
3957     0.297417  0.790940  0.570723  0.112106  0.257918  0.111110  0.590331   
3958     0.315417  0.794665  0.574270  0.110540  0.264979  0.109355  0.606812   
3959     0.247417  0.798287  0.575894  0.109686  0.288012  0.108329  0.660284   

        r_x(t)   r_vx(t)  
0     0.456504  0.213297  
1     0.135227  0.121000  
2     0.127831  0.125825  
3     0.120390  0.113966  
4     0.112370  0.109664  
...        ...       ...  
3955  0.112425  0.187258  
3956  0.108179  0.209177  
3957  0.104707  0.227227  
3958  0.101850  0.234488  
3959  0.099636  0.257864  

[3960 rows x 26 columns]
      LA.steer(t)  controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0        0.501667                  0.492489                  0.492489   
1        0.521667                  0.506556                  0.506556   
2        0.395000                  0.491778                  0.491778   
3        0.511667                  0.493756                  0.493756   
4        0.540000                  0.508444                  0.508444   
...           ...                       ...                       ...   
3955     0.586667                  0.499066                  0.499066   
3956     0.500000                  0.503999                  0.503999   
3957     0.463333                  0.500000                  0.500000   
3958     0.470000                  0.486289                  0.486289   
3959     0.440000                  0.495867                  0.495867   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  LA.acc(t)  \
0                     0.360667                  0.627333   0.486292   
1                     0.374000                  0.640667   0.511375   
2                     0.360667                  0.627333   0.501958   
3                     0.362667                  0.629333   0.564708   
4                     0.376000                  0.642667   0.444417   
...                        ...                       ...        ...   
3955                  0.356000                  0.622667   0.062083   
3956                  0.361333                  0.628000   0.297417   
3957                  0.358667                  0.625333   0.315417   
3958                  0.347333                  0.614000   0.247417   
3959                  0.358000                  0.624667   0.224958   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                   0.569367                0.336033                     0.5   
1                   0.561517                0.328183                     0.5   
2                   0.560100                0.326767                     0.5   
3                   0.547450                0.314117                     0.5   
4                   0.541250                0.307917                     0.5   
...                      ...                     ...                     ...   
3955                0.590483                0.357150                     0.5   
3956                0.606450                0.373117                     0.5   
3957                0.619583                0.386250                     0.5   
3958                0.624800                0.391467                     0.5   
3959                0.641817                0.408483                     0.5   

      controller-LA.acc-3(t)  
0                        0.5  
1                        0.5  
2                        0.5  
3                        0.5  
4                        0.5  
...                      ...  
3955                     0.5  
3956                     0.5  
3957                     0.5  
3958                     0.5  
3959                     0.5  

[3960 rows x 10 columns]
Training set size
1426
Test set size
158
Validation set size
3960
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 128)               79360     
                                                                 
 dense (Dense)               (None, 64)                8256      
                                                                 
 dense_1 (Dense)             (None, 16)                1040      
                                                                 
 dense_2 (Dense)             (None, 4)                 68        
                                                                 
 dense_3 (Dense)             (None, 4)                 20        
                                                                 
=================================================================
Total params: 88,744
Trainable params: 88,744
Non-trainable params: 0
_________________________________________________________________
None
 1/50 [..............................] - ETA: 30s44/50 [=========================>....] - ETA: 0s 50/50 [==============================] - 1s 1ms/step
  1/124 [..............................] - ETA: 2s 53/124 [===========>..................] - ETA: 0s 96/124 [======================>.......] - ETA: 0s124/124 [==============================] - 0s 1ms/step
######## Metrics: Weighted by softmax ########
Testing set percent accuracy: 89.34323636304606%
Testing set cumulative log obs (normalized): -1263.2405870660814
Validation set percent accuracy: 84.30100663058158%
Validation set cumulative log obs (normalized): -85658.92915726214

