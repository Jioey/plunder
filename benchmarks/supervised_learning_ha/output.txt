Relevant data:
        x(t-1)  y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0      201.689   5.189   239.652     21.476   215.174     20.295   320.774   
1      214.326   6.969   225.260     20.031   331.039     20.355   269.342   
2      226.979   7.832   235.233     19.852   341.159     20.107   279.778   
3      240.188   8.060   245.131     19.732   351.170     19.920   290.220   
4      253.736   7.990   254.978     19.653   361.097     19.780   300.659   
...        ...     ...       ...        ...       ...        ...       ...   
2935  1218.288   4.072  1235.569     19.646  1235.991     18.422  1218.288   
2936  1227.603   4.073  1245.391     19.641  1245.196     18.396  1227.603   
2937  1236.796   4.090  1255.210     19.635  1254.388     18.371  1236.796   
2938  1245.842   4.140  1265.026     19.630  1263.569     18.347  1245.842   
2939  1254.869   4.234  1274.840     19.625  1272.737     18.323  1254.869   

      r_vx(t-1)  HA(t-1)  controller-LA.steer-0(t-1)  \
0        20.680      3.0                   -0.081806   
1        20.837      0.0                   -0.051323   
2        20.883      0.0                   -0.018700   
3        20.882      0.0                   -0.010000   
4        20.870      0.0                    0.006667   
...         ...      ...                         ...   
2935     18.430      1.0                    0.006300   
2936     18.595      1.0                   -0.004217   
2937     18.160      1.0                   -0.002000   
2938     18.018      1.0                   -0.009333   
2939     17.996      1.0                   -0.008900   

      controller-LA.steer-1(t-1)  controller-LA.steer-2(t-1)  \
0                      -0.081806                     -0.1370   
1                      -0.051323                     -0.1435   
2                      -0.018700                     -0.0965   
3                      -0.010000                     -0.0840   
4                       0.006667                     -0.0685   
...                          ...                         ...   
2935                    0.006300                     -0.0675   
2936                   -0.004217                     -0.0780   
2937                   -0.002000                     -0.0755   
2938                   -0.009333                     -0.0820   
2939                   -0.008900                     -0.0800   

      controller-LA.steer-3(t-1)  controller-LA.acc-0(t-1)  \
0                         0.0130                    1.7768   
1                         0.0065                    2.0884   
2                         0.0535                    1.6324   
3                         0.0660                    1.3412   
4                         0.0815                    0.9464   
...                          ...                       ...   
2935                      0.0825                    4.6280   
2936                      0.0720                    4.5620   
2937                      0.0745                    4.7360   
2938                      0.0680                    4.7928   
2939                      0.0700                    4.8016   

      controller-LA.acc-1(t-1)  controller-LA.acc-2(t-1)  \
0                       -5.263                       0.0   
1                       -4.424                       0.0   
2                       -5.812                       0.0   
3                       -6.727                       0.0   
4                       -7.854                       0.0   
...                        ...                       ...   
2935                    -0.008                       0.0   
2936                    -0.199                       0.0   
2937                     0.211                       0.0   
2938                     0.329                       0.0   
2939                     0.327                       0.0   

      controller-LA.acc-3(t-1)  LA.steer(t-1)  LA.acc(t-1)      x(t)   y(t)  \
0                          0.0          0.024       -3.403   214.326  6.969   
1                          0.0         -0.070        2.724   226.979  7.832   
2                          0.0          0.015       -0.846   240.188  8.060   
3                          0.0         -0.044       -0.075   253.736  7.990   
4                          0.0         -0.012        3.407   267.717  7.952   
...                        ...            ...          ...       ...    ...   
2935                       0.0         -0.009       -0.158  1227.603  4.073   
2936                       0.0         -0.022        3.351  1236.796  4.090   
2937                       0.0          0.017        0.337  1245.842  4.140   
2938                       0.0         -0.025       -2.181  1254.869  4.234   
2939                       0.0          0.025        3.050  1263.878  4.311   

        l_x(t)  l_vx(t)    f_x(t)  f_vx(t)    r_x(t)  r_vx(t)  HA(t)  \
0      225.260   20.031   331.039   20.355   269.342   20.837      0   
1      235.233   19.852   341.159   20.107   279.778   20.883      0   
2      245.131   19.732   351.170   19.920   290.220   20.882      0   
3      254.978   19.653   361.097   19.780   300.659   20.870      0   
4      264.793   19.604   370.963   19.677   311.090   20.852      0   
...        ...      ...       ...      ...       ...      ...    ...   
2935  1245.391   19.641  1245.196   18.396  1227.603   18.595      1   
2936  1255.210   19.635  1254.388   18.371  1236.796   18.160      1   
2937  1265.026   19.630  1263.569   18.347  1245.842   18.018      1   
2938  1274.840   19.625  1272.737   18.323  1254.869   17.996      1   
2939  1284.652   19.620  1281.894   18.300  1263.878   18.251      1   

      controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0                    -0.051323                 -0.051323   
1                    -0.018700                 -0.018700   
2                    -0.010000                 -0.010000   
3                     0.006667                  0.006667   
4                     0.002800                  0.002800   
...                        ...                       ...   
2935                 -0.004217                 -0.004217   
2936                 -0.002000                 -0.002000   
2937                 -0.009333                 -0.009333   
2938                 -0.008900                 -0.008900   
2939                 -0.011683                 -0.011683   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  \
0                      -0.1435                    0.0065   
1                      -0.0965                    0.0535   
2                      -0.0840                    0.0660   
3                      -0.0685                    0.0815   
4                      -0.0730                    0.0770   
...                        ...                       ...   
2935                   -0.0780                    0.0720   
2936                   -0.0755                    0.0745   
2937                   -0.0820                    0.0680   
2938                   -0.0800                    0.0700   
2939                   -0.0815                    0.0685   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                     2.0884                  -4.424                     0.0   
1                     1.6324                  -5.812                     0.0   
2                     1.3412                  -6.727                     0.0   
3                     0.9464                  -7.854                     0.0   
4                     0.7952                  -8.335                     0.0   
...                      ...                     ...                     ...   
2935                  4.5620                  -0.199                     0.0   
2936                  4.7360                   0.211                     0.0   
2937                  4.7928                   0.329                     0.0   
2938                  4.8016                   0.327                     0.0   
2939                  4.6996                   0.049                     0.0   

      controller-LA.acc-3(t)  LA.steer(t)  LA.acc(t)  
0                        0.0       -0.070      2.724  
1                        0.0        0.015     -0.846  
2                        0.0       -0.044     -0.075  
3                        0.0       -0.012      3.407  
4                        0.0       -0.041      0.121  
...                      ...          ...        ...  
2935                     0.0       -0.022      3.351  
2936                     0.0        0.017      0.337  
2937                     0.0       -0.025     -2.181  
2938                     0.0        0.025      3.050  
2939                     0.0        0.005      0.320  

[2940 rows x 38 columns]


Relevant data: Scaled and reframed as a supervised learning problem


        x(t-1)    y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     0.026217  0.332928  0.089809   0.433357  0.073021   0.649051  0.138116   
1     0.034817  0.431336  0.080554   0.354131  0.146480   0.654891  0.105940   
2     0.043428  0.479047  0.086967   0.344317  0.152896   0.630754  0.112469   
3     0.052417  0.491652  0.093333   0.337738  0.159243   0.612555  0.119002   
4     0.061637  0.487782  0.099665   0.333406  0.165537   0.598929  0.125532   
...        ...       ...       ...        ...       ...        ...       ...   
2935  0.718063  0.271174  0.730275   0.333023  0.720223   0.466764  0.699600   
2936  0.724402  0.271230  0.736592   0.332749  0.726059   0.464234  0.705428   
2937  0.730658  0.272169  0.742906   0.332420  0.731887   0.461800  0.711179   
2938  0.736815  0.274934  0.749219   0.332145  0.737707   0.459465  0.716838   
2939  0.742958  0.280130  0.755530   0.331871  0.743520   0.457129  0.722485   

      r_vx(t-1)  HA(t-1)  controller-LA.steer-0(t-1)  \
0      0.397797      3.0                    0.363656   
1      0.406530      0.0                    0.414461   
2      0.409088      0.0                    0.468833   
3      0.409033      0.0                    0.483333   
4      0.408365      0.0                    0.511111   
...         ...      ...                         ...   
2935   0.272651      1.0                    0.510500   
2936   0.281829      1.0                    0.492972   
2937   0.257634      1.0                    0.496667   
2938   0.249736      1.0                    0.484444   
2939   0.248512      1.0                    0.485167   

      controller-LA.steer-1(t-1)  controller-LA.steer-2(t-1)  \
0                       0.363656                    0.271667   
1                       0.414461                    0.260833   
2                       0.468833                    0.339167   
3                       0.483333                    0.360000   
4                       0.511111                    0.385833   
...                          ...                         ...   
2935                    0.510500                    0.387500   
2936                    0.492972                    0.370000   
2937                    0.496667                    0.374167   
2938                    0.484444                    0.363333   
2939                    0.485167                    0.366667   

      controller-LA.steer-3(t-1)  controller-LA.acc-0(t-1)  \
0                       0.521667                   0.54442   
1                       0.510833                   0.55221   
2                       0.589167                   0.54081   
3                       0.610000                   0.53353   
4                       0.635833                   0.52366   
...                          ...                       ...   
2935                    0.637500                   0.61570   
2936                    0.620000                   0.61405   
2937                    0.624167                   0.61840   
2938                    0.613333                   0.61982   
2939                    0.616667                   0.62004   

      controller-LA.acc-1(t-1)  controller-LA.acc-2(t-1)  \
0                     0.368425                       0.5   
1                     0.389400                       0.5   
2                     0.354700                       0.5   
3                     0.331825                       0.5   
4                     0.303650                       0.5   
...                        ...                       ...   
2935                  0.499800                       0.5   
2936                  0.495025                       0.5   
2937                  0.505275                       0.5   
2938                  0.508225                       0.5   
2939                  0.508175                       0.5   

      controller-LA.acc-3(t-1)  LA.steer(t-1)  LA.acc(t-1)      x(t)  \
0                          0.5       0.540000     0.414925  0.026446   
1                          0.5       0.383333     0.568100  0.035041   
2                          0.5       0.525000     0.478850  0.044014   
3                          0.5       0.426667     0.498125  0.053217   
4                          0.5       0.480000     0.585175  0.062714   
...                        ...            ...          ...       ...   
2935                       0.5       0.485000     0.496050  0.714766   
2936                       0.5       0.463333     0.583775  0.721011   
2937                       0.5       0.528333     0.508425  0.727156   
2938                       0.5       0.458333     0.445475  0.733288   
2939                       0.5       0.541667     0.576250  0.739408   

          y(t)    l_x(t)   l_vx(t)    f_x(t)   f_vx(t)    r_x(t)   r_vx(t)  \
0     0.431336  0.078575  0.354131  0.143645  0.654891  0.105940  0.406530   
1     0.479047  0.084831  0.344317  0.149936  0.630754  0.112469  0.409088   
2     0.491652  0.091040  0.337738  0.156161  0.612555  0.119002  0.409033   
3     0.487782  0.097217  0.333406  0.162333  0.598929  0.125532  0.408365   
4     0.485681  0.103374  0.330720  0.168467  0.588905  0.132058  0.407364   
...        ...       ...       ...       ...       ...       ...       ...   
2935  0.271230  0.718499  0.332749  0.712006  0.464234  0.705428  0.281829   
2936  0.272169  0.724658  0.332420  0.717721  0.461800  0.711179  0.257634   
2937  0.274934  0.730816  0.332145  0.723429  0.459465  0.716838  0.249736   
2938  0.280130  0.736972  0.331871  0.729129  0.457129  0.722485  0.248512   
2939  0.284387  0.743127  0.331597  0.734822  0.454891  0.728121  0.262695   

      HA(t)  controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0         0                  0.414461                  0.414461   
1         0                  0.468833                  0.468833   
2         0                  0.483333                  0.483333   
3         0                  0.511111                  0.511111   
4         0                  0.504667                  0.504667   
...     ...                       ...                       ...   
2935      1                  0.492972                  0.492972   
2936      1                  0.496667                  0.496667   
2937      1                  0.484444                  0.484444   
2938      1                  0.485167                  0.485167   
2939      1                  0.480528                  0.480528   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  \
0                     0.260833                  0.510833   
1                     0.339167                  0.589167   
2                     0.360000                  0.610000   
3                     0.385833                  0.635833   
4                     0.378333                  0.628333   
...                        ...                       ...   
2935                  0.370000                  0.620000   
2936                  0.374167                  0.624167   
2937                  0.363333                  0.613333   
2938                  0.366667                  0.616667   
2939                  0.364167                  0.614167   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                    0.55221                0.389400                     0.5   
1                    0.54081                0.354700                     0.5   
2                    0.53353                0.331825                     0.5   
3                    0.52366                0.303650                     0.5   
4                    0.51988                0.291625                     0.5   
...                      ...                     ...                     ...   
2935                 0.61405                0.495025                     0.5   
2936                 0.61840                0.505275                     0.5   
2937                 0.61982                0.508225                     0.5   
2938                 0.62004                0.508175                     0.5   
2939                 0.61749                0.501225                     0.5   

      controller-LA.acc-3(t)  LA.steer(t)  LA.acc(t)  
0                        0.5     0.383333   0.568100  
1                        0.5     0.525000   0.478850  
2                        0.5     0.426667   0.498125  
3                        0.5     0.480000   0.585175  
4                        0.5     0.431667   0.503025  
...                      ...          ...        ...  
2935                     0.5     0.463333   0.583775  
2936                     0.5     0.528333   0.508425  
2937                     0.5     0.458333   0.445475  
2938                     0.5     0.541667   0.576250  
2939                     0.5     0.508333   0.508000  

[2940 rows x 38 columns]
        x(t-1)    y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     0.026217  0.332928  0.089809   0.433357  0.073021   0.649051  0.138116   
1     0.034817  0.431336  0.080554   0.354131  0.146480   0.654891  0.105940   
2     0.043428  0.479047  0.086967   0.344317  0.152896   0.630754  0.112469   
3     0.052417  0.491652  0.093333   0.337738  0.159243   0.612555  0.119002   
4     0.061637  0.487782  0.099665   0.333406  0.165537   0.598929  0.125532   
...        ...       ...       ...        ...       ...        ...       ...   
2935  0.718063  0.271174  0.730275   0.333023  0.720223   0.466764  0.699600   
2936  0.724402  0.271230  0.736592   0.332749  0.726059   0.464234  0.705428   
2937  0.730658  0.272169  0.742906   0.332420  0.731887   0.461800  0.711179   
2938  0.736815  0.274934  0.749219   0.332145  0.737707   0.459465  0.716838   
2939  0.742958  0.280130  0.755530   0.331871  0.743520   0.457129  0.722485   

      r_vx(t-1)  controller-LA.steer-0(t-1)  controller-LA.steer-1(t-1)  \
0      0.397797                    0.363656                    0.363656   
1      0.406530                    0.414461                    0.414461   
2      0.409088                    0.468833                    0.468833   
3      0.409033                    0.483333                    0.483333   
4      0.408365                    0.511111                    0.511111   
...         ...                         ...                         ...   
2935   0.272651                    0.510500                    0.510500   
2936   0.281829                    0.492972                    0.492972   
2937   0.257634                    0.496667                    0.496667   
2938   0.249736                    0.484444                    0.484444   
2939   0.248512                    0.485167                    0.485167   

      controller-LA.steer-2(t-1)  controller-LA.steer-3(t-1)  \
0                       0.271667                    0.521667   
1                       0.260833                    0.510833   
2                       0.339167                    0.589167   
3                       0.360000                    0.610000   
4                       0.385833                    0.635833   
...                          ...                         ...   
2935                    0.387500                    0.637500   
2936                    0.370000                    0.620000   
2937                    0.374167                    0.624167   
2938                    0.363333                    0.613333   
2939                    0.366667                    0.616667   

      controller-LA.acc-0(t-1)  controller-LA.acc-1(t-1)  \
0                      0.54442                  0.368425   
1                      0.55221                  0.389400   
2                      0.54081                  0.354700   
3                      0.53353                  0.331825   
4                      0.52366                  0.303650   
...                        ...                       ...   
2935                   0.61570                  0.499800   
2936                   0.61405                  0.495025   
2937                   0.61840                  0.505275   
2938                   0.61982                  0.508225   
2939                   0.62004                  0.508175   

      controller-LA.acc-2(t-1)  controller-LA.acc-3(t-1)  LA.steer(t-1)  \
0                          0.5                       0.5       0.540000   
1                          0.5                       0.5       0.383333   
2                          0.5                       0.5       0.525000   
3                          0.5                       0.5       0.426667   
4                          0.5                       0.5       0.480000   
...                        ...                       ...            ...   
2935                       0.5                       0.5       0.485000   
2936                       0.5                       0.5       0.463333   
2937                       0.5                       0.5       0.528333   
2938                       0.5                       0.5       0.458333   
2939                       0.5                       0.5       0.541667   

      LA.acc(t-1)      x(t)      y(t)    l_x(t)   l_vx(t)    f_x(t)   f_vx(t)  \
0        0.414925  0.026446  0.431336  0.078575  0.354131  0.143645  0.654891   
1        0.568100  0.035041  0.479047  0.084831  0.344317  0.149936  0.630754   
2        0.478850  0.044014  0.491652  0.091040  0.337738  0.156161  0.612555   
3        0.498125  0.053217  0.487782  0.097217  0.333406  0.162333  0.598929   
4        0.585175  0.062714  0.485681  0.103374  0.330720  0.168467  0.588905   
...           ...       ...       ...       ...       ...       ...       ...   
2935     0.496050  0.714766  0.271230  0.718499  0.332749  0.712006  0.464234   
2936     0.583775  0.721011  0.272169  0.724658  0.332420  0.717721  0.461800   
2937     0.508425  0.727156  0.274934  0.730816  0.332145  0.723429  0.459465   
2938     0.445475  0.733288  0.280130  0.736972  0.331871  0.729129  0.457129   
2939     0.576250  0.739408  0.284387  0.743127  0.331597  0.734822  0.454891   

        r_x(t)   r_vx(t)  
0     0.105940  0.406530  
1     0.112469  0.409088  
2     0.119002  0.409033  
3     0.125532  0.408365  
4     0.132058  0.407364  
...        ...       ...  
2935  0.705428  0.281829  
2936  0.711179  0.257634  
2937  0.716838  0.249736  
2938  0.722485  0.248512  
2939  0.728121  0.262695  

[2940 rows x 26 columns]
      LA.steer(t)  controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0        0.383333                  0.414461                  0.414461   
1        0.525000                  0.468833                  0.468833   
2        0.426667                  0.483333                  0.483333   
3        0.480000                  0.511111                  0.511111   
4        0.431667                  0.504667                  0.504667   
...           ...                       ...                       ...   
2935     0.463333                  0.492972                  0.492972   
2936     0.528333                  0.496667                  0.496667   
2937     0.458333                  0.484444                  0.484444   
2938     0.541667                  0.485167                  0.485167   
2939     0.508333                  0.480528                  0.480528   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  LA.acc(t)  \
0                     0.260833                  0.510833   0.568100   
1                     0.339167                  0.589167   0.478850   
2                     0.360000                  0.610000   0.498125   
3                     0.385833                  0.635833   0.585175   
4                     0.378333                  0.628333   0.503025   
...                        ...                       ...        ...   
2935                  0.370000                  0.620000   0.583775   
2936                  0.374167                  0.624167   0.508425   
2937                  0.363333                  0.613333   0.445475   
2938                  0.366667                  0.616667   0.576250   
2939                  0.364167                  0.614167   0.508000   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                    0.55221                0.389400                     0.5   
1                    0.54081                0.354700                     0.5   
2                    0.53353                0.331825                     0.5   
3                    0.52366                0.303650                     0.5   
4                    0.51988                0.291625                     0.5   
...                      ...                     ...                     ...   
2935                 0.61405                0.495025                     0.5   
2936                 0.61840                0.505275                     0.5   
2937                 0.61982                0.508225                     0.5   
2938                 0.62004                0.508175                     0.5   
2939                 0.61749                0.501225                     0.5   

      controller-LA.acc-3(t)  
0                        0.5  
1                        0.5  
2                        0.5  
3                        0.5  
4                        0.5  
...                      ...  
2935                     0.5  
2936                     0.5  
2937                     0.5  
2938                     0.5  
2939                     0.5  

[2940 rows x 10 columns]
Training set size
686
Test set size
294
Validation set size
2940
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 128)               79360     
                                                                 
 dense (Dense)               (None, 64)                8256      
                                                                 
 dense_1 (Dense)             (None, 16)                1040      
                                                                 
 dense_2 (Dense)             (None, 4)                 68        
                                                                 
 dense_3 (Dense)             (None, 4)                 20        
                                                                 
=================================================================
Total params: 88,744
Trainable params: 88,744
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1695: early stopping
 1/31 [..............................] - ETA: 12s31/31 [==============================] - 0s 958us/step
 1/92 [..............................] - ETA: 1s55/92 [================>.............] - ETA: 0s92/92 [==============================] - 0s 902us/step
######## Metrics: Weighted by softmax ########
Testing set percent accuracy: 11.684189221233115%
Testing set cumulative log obs: -26278.823046397745
Validation set percent accuracy: 8.779662315745412%
Validation set cumulative log obs: -131528.01525156086

