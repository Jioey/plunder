Relevant data:
       x(t-1)  y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     189.835   0.152   189.835     24.920   210.433     21.333   272.479   
1     192.930   0.508   192.930     24.740   213.073     20.946   275.057   
2     196.007   0.939   196.007     24.603   215.686     20.716   277.540   
3     199.075   1.392   199.075     24.499   258.711     22.486   218.281   
4     202.132   1.858   202.132     24.417   261.515     22.326   220.868   
...       ...     ...       ...        ...       ...        ...       ...   
2185  450.984   3.946   459.172     17.728   462.925     19.880   450.984   
2186  453.485   3.954   461.389     17.755   465.410     19.869   453.485   
2187  455.983   3.931   463.609     17.781   467.893     19.858   455.983   
2188  458.478   3.937   465.833     17.806   470.375     19.847   458.478   
2189  460.973   3.939   468.060     17.830   472.855     19.837   460.973   

      r_vx(t-1)  HA(t-1)  controller-LA.steer-0(t-1)  \
0        20.868      3.0                   -0.011000   
1        20.118      3.0                    0.021000   
2        19.368      3.0                   -0.033000   
3        20.633      3.0                   -0.064000   
4        20.585      3.0                   -0.071000   
...         ...      ...                         ...   
2185     20.013      1.0                    0.001800   
2186     19.993      1.0                   -0.001467   
2187     19.964      1.0                    0.008300   
2188     19.958      1.0                    0.002100   
2189     19.957      1.0                    0.001033   

      controller-LA.steer-1(t-1)  controller-LA.steer-2(t-1)  \
0                      -0.011000                      -0.011   
1                       0.021000                       0.021   
2                      -0.033000                      -0.033   
3                      -0.064000                      -0.064   
4                      -0.071000                      -0.071   
...                          ...                         ...   
2185                    0.001800                      -0.081   
2186                   -0.001467                      -0.075   
2187                    0.008300                      -0.098   
2188                    0.002100                      -0.067   
2189                    0.001033                      -0.079   

      controller-LA.steer-3(t-1)  controller-LA.acc-0(t-1)  \
0                          0.107                     3.545   
1                          0.044                     3.490   
2                          0.015                     3.599   
3                          0.005                     3.440   
4                          0.000                     3.492   
...                          ...                       ...   
2185                       0.079                     3.996   
2186                       0.085                     3.833   
2187                       0.062                     3.772   
2188                       0.093                     3.950   
2189                       0.081                     3.989   

      controller-LA.acc-1(t-1)  controller-LA.acc-2(t-1)  \
0                       -3.587                      -0.5   
1                       -3.794                      -0.5   
2                       -3.887                      -0.5   
3                       -2.013                      -0.5   
4                       -2.091                      -0.5   
...                        ...                       ...   
2185                    -0.133                      -0.5   
2186                    -0.124                      -0.5   
2187                    -0.106                      -0.5   
2188                    -0.111                      -0.5   
2189                    -0.120                      -0.5   

      controller-LA.acc-3(t-1)  LA.steer(t-1)  LA.acc(t-1)     x(t)   y(t)  \
0                         -0.5          0.101       -0.510  192.930  0.508   
1                         -0.5          0.047       -0.401  196.007  0.939   
2                         -0.5          0.016       -0.560  199.075  1.392   
3                         -0.5          0.009       -0.508  202.132  1.858   
4                         -0.5         -0.001       -0.534  205.181  2.319   
...                        ...            ...          ...      ...    ...   
2185                      -0.5          0.005       -0.167  453.485  3.954   
2186                      -0.5         -0.018       -0.228  455.983  3.931   
2187                      -0.5          0.013       -0.050  458.478  3.937   
2188                      -0.5          0.001       -0.011  460.973  3.939   
2189                      -0.5         -0.010       -0.118  463.466  3.924   

       l_x(t)  l_vx(t)   f_x(t)  f_vx(t)   r_x(t)  r_vx(t)  HA(t)  \
0     192.930   24.740  213.073   20.946  275.057   20.118      3   
1     196.007   24.603  215.686   20.716  277.540   19.368      3   
2     199.075   24.499  258.711   22.486  218.281   20.633      3   
3     202.132   24.417  261.515   22.326  220.868   20.585      3   
4     264.299   22.176  223.446   20.511  244.474   21.962      3   
...       ...      ...      ...      ...      ...      ...    ...   
2185  461.389   17.755  465.410   19.869  453.485   19.993      1   
2186  463.609   17.781  467.893   19.858  455.983   19.964      1   
2187  465.833   17.806  470.375   19.847  458.478   19.958      1   
2188  468.060   17.830  472.855   19.837  460.973   19.957      1   
2189  470.289   17.853  475.335   19.826  463.466   19.942      1   

      controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0                     0.021000                  0.021000   
1                    -0.033000                 -0.033000   
2                    -0.064000                 -0.064000   
3                    -0.071000                 -0.071000   
4                    -0.081000                 -0.081000   
...                        ...                       ...   
2185                 -0.001467                 -0.001467   
2186                  0.008300                  0.008300   
2187                  0.002100                  0.002100   
2188                  0.001033                  0.001033   
2189                  0.006533                  0.006533   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  \
0                        0.021                     0.044   
1                       -0.033                     0.015   
2                       -0.064                     0.005   
3                       -0.071                     0.000   
4                       -0.081                     0.000   
...                        ...                       ...   
2185                    -0.075                     0.085   
2186                    -0.098                     0.062   
2187                    -0.067                     0.093   
2188                    -0.079                     0.081   
2189                    -0.090                     0.070   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                      3.490                  -3.794                    -0.5   
1                      3.599                  -3.887                    -0.5   
2                      3.440                  -2.013                    -0.5   
3                      3.492                  -2.091                    -0.5   
4                      3.466                  -3.841                    -0.5   
...                      ...                     ...                     ...   
2185                   3.833                  -0.124                    -0.5   
2186                   3.772                  -0.106                    -0.5   
2187                   3.950                  -0.111                    -0.5   
2188                   3.989                  -0.120                    -0.5   
2189                   3.882                  -0.116                    -0.5   

      controller-LA.acc-3(t)  LA.steer(t)  LA.acc(t)  
0                       -0.5        0.047     -0.401  
1                       -0.5        0.016     -0.560  
2                       -0.5        0.009     -0.508  
3                       -0.5       -0.001     -0.534  
4                       -0.5        0.002     -0.432  
...                      ...          ...        ...  
2185                    -0.5       -0.018     -0.228  
2186                    -0.5        0.013     -0.050  
2187                    -0.5        0.001     -0.011  
2188                    -0.5       -0.010     -0.118  
2189                    -0.5        0.006     -0.275  

[2190 rows x 38 columns]


Relevant data: Scaled and reframed as a supervised learning problem


        x(t-1)    y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     0.112631  0.010856  0.186661   0.442050  0.232678   0.732865  0.403065   
1     0.120755  0.028584  0.193092   0.435465  0.238240   0.702995  0.409089   
2     0.128831  0.050047  0.199485   0.430453  0.243745   0.685242  0.414892   
3     0.136883  0.072606  0.205860   0.426648  0.334397   0.821859  0.276410   
4     0.144907  0.095812  0.212212   0.423648  0.340305   0.809509  0.282455   
...        ...       ...       ...        ...       ...        ...       ...   
2185  0.798069  0.199791  0.746294   0.178935  0.764668   0.620716  0.820211   
2186  0.804633  0.200189  0.750901   0.179922  0.769903   0.619867  0.826056   
2187  0.811190  0.199044  0.755513   0.180874  0.775135   0.619018  0.831893   
2188  0.817738  0.199343  0.760135   0.181788  0.780364   0.618169  0.837724   
2189  0.824287  0.199442  0.764762   0.182666  0.785590   0.617397  0.843555   

      r_vx(t-1)  HA(t-1)  controller-LA.steer-0(t-1)  \
0      0.328347      3.0                    0.481667   
1      0.302254      3.0                    0.535000   
2      0.276162      3.0                    0.445000   
3      0.320171      3.0                    0.393333   
4      0.318501      3.0                    0.381667   
...         ...      ...                         ...   
2185   0.298601      1.0                    0.503000   
2186   0.297906      1.0                    0.497556   
2187   0.296897      1.0                    0.513833   
2188   0.296688      1.0                    0.503500   
2189   0.296653      1.0                    0.501722   

      controller-LA.steer-1(t-1)  controller-LA.steer-2(t-1)  \
0                       0.481667                    0.481667   
1                       0.535000                    0.535000   
2                       0.445000                    0.445000   
3                       0.393333                    0.393333   
4                       0.381667                    0.381667   
...                          ...                         ...   
2185                    0.503000                    0.365000   
2186                    0.497556                    0.375000   
2187                    0.513833                    0.336667   
2188                    0.503500                    0.388333   
2189                    0.501722                    0.368333   

      controller-LA.steer-3(t-1)  controller-LA.acc-0(t-1)  \
0                       0.678333                  0.588625   
1                       0.573333                  0.587250   
2                       0.525000                  0.589975   
3                       0.508333                  0.586000   
4                       0.500000                  0.587300   
...                          ...                       ...   
2185                    0.631667                  0.599900   
2186                    0.641667                  0.595825   
2187                    0.603333                  0.594300   
2188                    0.655000                  0.598750   
2189                    0.635000                  0.599725   

      controller-LA.acc-1(t-1)  controller-LA.acc-2(t-1)  \
0                     0.410325                    0.4875   
1                     0.405150                    0.4875   
2                     0.402825                    0.4875   
3                     0.449675                    0.4875   
4                     0.447725                    0.4875   
...                        ...                       ...   
2185                  0.496675                    0.4875   
2186                  0.496900                    0.4875   
2187                  0.497350                    0.4875   
2188                  0.497225                    0.4875   
2189                  0.497000                    0.4875   

      controller-LA.acc-3(t-1)  LA.steer(t-1)  LA.acc(t-1)      x(t)  \
0                       0.4875       0.668333     0.487250  0.112246   
1                       0.4875       0.578333     0.489975  0.120317   
2                       0.4875       0.526667     0.486000  0.128364   
3                       0.4875       0.515000     0.487300  0.136382   
4                       0.4875       0.498333     0.486650  0.144380   
...                        ...            ...          ...       ...   
2185                    0.4875       0.508333     0.495825  0.795665   
2186                    0.4875       0.470000     0.494300  0.802217   
2187                    0.4875       0.521667     0.498750  0.808762   
2188                    0.4875       0.501667     0.499725  0.815306   
2189                    0.4875       0.483333     0.497050  0.821845   

          y(t)    l_x(t)   l_vx(t)    f_x(t)   f_vx(t)    r_x(t)   r_vx(t)  \
0     0.028584  0.192027  0.435465  0.236995  0.702995  0.405799  0.302254   
1     0.050047  0.198385  0.430453  0.242472  0.685242  0.411555  0.276162   
2     0.072606  0.204725  0.426648  0.332650  0.821859  0.274187  0.320171   
3     0.095812  0.211042  0.423648  0.338527  0.809509  0.280184  0.318501   
4     0.118769  0.339501  0.341662  0.258736  0.669420  0.334905  0.366407   
...        ...       ...       ...       ...       ...       ...       ...   
2185  0.200189  0.746761  0.179922  0.765880  0.619867  0.819413  0.297906   
2186  0.199044  0.751348  0.180874  0.771085  0.619018  0.825204  0.296897   
2187  0.199343  0.755944  0.181788  0.776287  0.618169  0.830987  0.296688   
2188  0.199442  0.760546  0.182666  0.781485  0.617397  0.836771  0.296653   
2189  0.198695  0.765152  0.183508  0.786683  0.616548  0.842550  0.296131   

      HA(t)  controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0         3                  0.535000                  0.535000   
1         3                  0.445000                  0.445000   
2         3                  0.393333                  0.393333   
3         3                  0.381667                  0.381667   
4         3                  0.365000                  0.365000   
...     ...                       ...                       ...   
2185      1                  0.497556                  0.497556   
2186      1                  0.513833                  0.513833   
2187      1                  0.503500                  0.503500   
2188      1                  0.501722                  0.501722   
2189      1                  0.510889                  0.510889   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  \
0                     0.535000                  0.573333   
1                     0.445000                  0.525000   
2                     0.393333                  0.508333   
3                     0.381667                  0.500000   
4                     0.365000                  0.500000   
...                        ...                       ...   
2185                  0.375000                  0.641667   
2186                  0.336667                  0.603333   
2187                  0.388333                  0.655000   
2188                  0.368333                  0.635000   
2189                  0.350000                  0.616667   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                   0.587250                0.405150                  0.4875   
1                   0.589975                0.402825                  0.4875   
2                   0.586000                0.449675                  0.4875   
3                   0.587300                0.447725                  0.4875   
4                   0.586650                0.403975                  0.4875   
...                      ...                     ...                     ...   
2185                0.595825                0.496900                  0.4875   
2186                0.594300                0.497350                  0.4875   
2187                0.598750                0.497225                  0.4875   
2188                0.599725                0.497000                  0.4875   
2189                0.597050                0.497100                  0.4875   

      controller-LA.acc-3(t)  LA.steer(t)  LA.acc(t)  
0                     0.4875     0.578333   0.489975  
1                     0.4875     0.526667   0.486000  
2                     0.4875     0.515000   0.487300  
3                     0.4875     0.498333   0.486650  
4                     0.4875     0.503333   0.489200  
...                      ...          ...        ...  
2185                  0.4875     0.470000   0.494300  
2186                  0.4875     0.521667   0.498750  
2187                  0.4875     0.501667   0.499725  
2188                  0.4875     0.483333   0.497050  
2189                  0.4875     0.510000   0.493125  

[2190 rows x 38 columns]
        x(t-1)    y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     0.112631  0.010856  0.186661   0.442050  0.232678   0.732865  0.403065   
1     0.120755  0.028584  0.193092   0.435465  0.238240   0.702995  0.409089   
2     0.128831  0.050047  0.199485   0.430453  0.243745   0.685242  0.414892   
3     0.136883  0.072606  0.205860   0.426648  0.334397   0.821859  0.276410   
4     0.144907  0.095812  0.212212   0.423648  0.340305   0.809509  0.282455   
...        ...       ...       ...        ...       ...        ...       ...   
2185  0.798069  0.199791  0.746294   0.178935  0.764668   0.620716  0.820211   
2186  0.804633  0.200189  0.750901   0.179922  0.769903   0.619867  0.826056   
2187  0.811190  0.199044  0.755513   0.180874  0.775135   0.619018  0.831893   
2188  0.817738  0.199343  0.760135   0.181788  0.780364   0.618169  0.837724   
2189  0.824287  0.199442  0.764762   0.182666  0.785590   0.617397  0.843555   

      r_vx(t-1)  controller-LA.steer-0(t-1)  controller-LA.steer-1(t-1)  \
0      0.328347                    0.481667                    0.481667   
1      0.302254                    0.535000                    0.535000   
2      0.276162                    0.445000                    0.445000   
3      0.320171                    0.393333                    0.393333   
4      0.318501                    0.381667                    0.381667   
...         ...                         ...                         ...   
2185   0.298601                    0.503000                    0.503000   
2186   0.297906                    0.497556                    0.497556   
2187   0.296897                    0.513833                    0.513833   
2188   0.296688                    0.503500                    0.503500   
2189   0.296653                    0.501722                    0.501722   

      controller-LA.steer-2(t-1)  controller-LA.steer-3(t-1)  \
0                       0.481667                    0.678333   
1                       0.535000                    0.573333   
2                       0.445000                    0.525000   
3                       0.393333                    0.508333   
4                       0.381667                    0.500000   
...                          ...                         ...   
2185                    0.365000                    0.631667   
2186                    0.375000                    0.641667   
2187                    0.336667                    0.603333   
2188                    0.388333                    0.655000   
2189                    0.368333                    0.635000   

      controller-LA.acc-0(t-1)  controller-LA.acc-1(t-1)  \
0                     0.588625                  0.410325   
1                     0.587250                  0.405150   
2                     0.589975                  0.402825   
3                     0.586000                  0.449675   
4                     0.587300                  0.447725   
...                        ...                       ...   
2185                  0.599900                  0.496675   
2186                  0.595825                  0.496900   
2187                  0.594300                  0.497350   
2188                  0.598750                  0.497225   
2189                  0.599725                  0.497000   

      controller-LA.acc-2(t-1)  controller-LA.acc-3(t-1)  LA.steer(t-1)  \
0                       0.4875                    0.4875       0.668333   
1                       0.4875                    0.4875       0.578333   
2                       0.4875                    0.4875       0.526667   
3                       0.4875                    0.4875       0.515000   
4                       0.4875                    0.4875       0.498333   
...                        ...                       ...            ...   
2185                    0.4875                    0.4875       0.508333   
2186                    0.4875                    0.4875       0.470000   
2187                    0.4875                    0.4875       0.521667   
2188                    0.4875                    0.4875       0.501667   
2189                    0.4875                    0.4875       0.483333   

      LA.acc(t-1)      x(t)      y(t)    l_x(t)   l_vx(t)    f_x(t)   f_vx(t)  \
0        0.487250  0.112246  0.028584  0.192027  0.435465  0.236995  0.702995   
1        0.489975  0.120317  0.050047  0.198385  0.430453  0.242472  0.685242   
2        0.486000  0.128364  0.072606  0.204725  0.426648  0.332650  0.821859   
3        0.487300  0.136382  0.095812  0.211042  0.423648  0.338527  0.809509   
4        0.486650  0.144380  0.118769  0.339501  0.341662  0.258736  0.669420   
...           ...       ...       ...       ...       ...       ...       ...   
2185     0.495825  0.795665  0.200189  0.746761  0.179922  0.765880  0.619867   
2186     0.494300  0.802217  0.199044  0.751348  0.180874  0.771085  0.619018   
2187     0.498750  0.808762  0.199343  0.755944  0.181788  0.776287  0.618169   
2188     0.499725  0.815306  0.199442  0.760546  0.182666  0.781485  0.617397   
2189     0.497050  0.821845  0.198695  0.765152  0.183508  0.786683  0.616548   

        r_x(t)   r_vx(t)  
0     0.405799  0.302254  
1     0.411555  0.276162  
2     0.274187  0.320171  
3     0.280184  0.318501  
4     0.334905  0.366407  
...        ...       ...  
2185  0.819413  0.297906  
2186  0.825204  0.296897  
2187  0.830987  0.296688  
2188  0.836771  0.296653  
2189  0.842550  0.296131  

[2190 rows x 26 columns]
      LA.steer(t)  controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0        0.578333                  0.535000                  0.535000   
1        0.526667                  0.445000                  0.445000   
2        0.515000                  0.393333                  0.393333   
3        0.498333                  0.381667                  0.381667   
4        0.503333                  0.365000                  0.365000   
...           ...                       ...                       ...   
2185     0.470000                  0.497556                  0.497556   
2186     0.521667                  0.513833                  0.513833   
2187     0.501667                  0.503500                  0.503500   
2188     0.483333                  0.501722                  0.501722   
2189     0.510000                  0.510889                  0.510889   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  LA.acc(t)  \
0                     0.535000                  0.573333   0.489975   
1                     0.445000                  0.525000   0.486000   
2                     0.393333                  0.508333   0.487300   
3                     0.381667                  0.500000   0.486650   
4                     0.365000                  0.500000   0.489200   
...                        ...                       ...        ...   
2185                  0.375000                  0.641667   0.494300   
2186                  0.336667                  0.603333   0.498750   
2187                  0.388333                  0.655000   0.499725   
2188                  0.368333                  0.635000   0.497050   
2189                  0.350000                  0.616667   0.493125   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                   0.587250                0.405150                  0.4875   
1                   0.589975                0.402825                  0.4875   
2                   0.586000                0.449675                  0.4875   
3                   0.587300                0.447725                  0.4875   
4                   0.586650                0.403975                  0.4875   
...                      ...                     ...                     ...   
2185                0.595825                0.496900                  0.4875   
2186                0.594300                0.497350                  0.4875   
2187                0.598750                0.497225                  0.4875   
2188                0.599725                0.497000                  0.4875   
2189                0.597050                0.497100                  0.4875   

      controller-LA.acc-3(t)  
0                     0.4875  
1                     0.4875  
2                     0.4875  
3                     0.4875  
4                     0.4875  
...                      ...  
2185                  0.4875  
2186                  0.4875  
2187                  0.4875  
2188                  0.4875  
2189                  0.4875  

[2190 rows x 10 columns]
Training set size
511
Test set size
219
Validation set size
2190
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 128)               79360     
                                                                 
 dense (Dense)               (None, 64)                8256      
                                                                 
 dense_1 (Dense)             (None, 16)                1040      
                                                                 
 dense_2 (Dense)             (None, 4)                 68        
                                                                 
 dense_3 (Dense)             (None, 4)                 20        
                                                                 
=================================================================
Total params: 88,744
Trainable params: 88,744
Non-trainable params: 0
_________________________________________________________________
None
Epoch 829: early stopping
 1/23 [>.............................] - ETA: 12s23/23 [==============================] - 1s 1ms/step
 1/69 [..............................] - ETA: 1s56/69 [=======================>......] - ETA: 0s69/69 [==============================] - 0s 910us/step
######## Metrics: Weighted by softmax ########
Testing set percent accuracy: 82.96351293931167%
Testing set cumulative log obs: 0.8931458007209744
Validation set percent accuracy: 80.07977775638268%
Validation set cumulative log obs: 0.7441131474867807

