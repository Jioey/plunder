Relevant data:
        x(t-1)  y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0      193.515   8.087   253.096     21.491   295.790     20.943   214.220   
1      198.724   8.146   257.388     21.404   299.889     19.763   218.186   
2      204.001   8.203   261.662     21.311   303.771     18.899   221.911   
3      209.352   8.168   265.917     21.214   307.504     18.318   225.415   
4      214.817   8.188   270.152     21.112   311.134     17.903   228.760   
...        ...     ...       ...        ...       ...        ...       ...   
3955  1305.831   0.674  1305.831     29.158  1343.150     20.087  1326.002   
3956  1311.679   0.253  1311.679     29.541  1347.168     20.091  1329.999   
3957  1317.622  -0.093  1317.622     30.040  1351.186     20.094  1333.997   
3958  1323.635  -0.232  1323.635     30.046  1355.206     20.098  1337.996   
3959  1329.513  -0.244  1329.513     28.156  1359.226     20.101  1341.994   

      r_vx(t-1)  HA(t-1)  controller-LA.steer-0(t-1)  \
0        20.278      0.0                   -0.003560   
1        19.078      0.0                   -0.007947   
2        17.889      0.0                   -0.004307   
3        16.978      0.0                    0.002960   
4        16.346      0.0                   -0.004507   
...         ...      ...                         ...   
3955     19.987      0.0                    0.036215   
3956     19.989      0.0                    0.023427   
3957     19.991      0.0                    0.022840   
3958     19.992      1.0                    0.008693   
3959     19.994      0.0                    0.005653   

      controller-LA.steer-1(t-1)  controller-LA.steer-2(t-1)  \
0                      -0.003560                     -0.0824   
1                      -0.007947                     -0.0860   
2                      -0.004307                     -0.0816   
3                       0.002960                     -0.0748   
4                      -0.004507                     -0.0820   
...                          ...                         ...   
3955                    0.036215                     -0.0348   
3956                    0.023427                     -0.0532   
3957                    0.022840                     -0.0584   
3958                    0.008693                     -0.0744   
3959                    0.005653                     -0.0776   

      controller-LA.steer-3(t-1)  controller-LA.acc-0(t-1)  \
0                         0.0776                    1.6332   
1                         0.0740                    1.4420   
2                         0.0784                    1.3960   
3                         0.0852                    1.1328   
4                         0.0780                    1.0308   
...                          ...                       ...   
3955                      0.1252                    0.3368   
3956                      0.1068                    0.1836   
3957                      0.1016                   -0.0160   
3958                      0.0856                   -0.0184   
3959                      0.0824                    0.7376   

      controller-LA.acc-1(t-1)  controller-LA.acc-2(t-1)  \
0                       -4.974                       0.0   
1                       -6.632                       0.0   
2                       -7.611                       0.0   
3                       -8.850                       0.0   
4                       -9.520                       0.0   
...                        ...                       ...   
3955                    -9.071                       0.0   
3956                    -9.450                       0.0   
3957                    -9.946                       0.0   
3958                    -9.948                       0.0   
3959                    -8.055                       0.0   

      controller-LA.acc-3(t-1)  LA.steer(t-1)  LA.acc(t-1)      x(t)   y(t)  \
0                          0.0         -0.022       -0.129   198.724  8.146   
1                          0.0          0.003        3.170   204.001  8.203   
2                          0.0          0.007        3.272   209.352  8.168   
3                          0.0          0.029        5.695   214.817  8.188   
4                          0.0         -0.014        1.050   220.323  8.190   
...                        ...            ...          ...       ...    ...   
3955                       0.0          0.041       -0.906  1311.679  0.253   
3956                       0.0         -0.030       -3.638  1317.622 -0.093   
3957                       0.0          0.023       -2.549  1323.635 -0.232   
3958                       0.0          0.011      -13.878  1329.513 -0.244   
3959                       0.0         -0.014        0.504  1335.157 -0.259   

        l_x(t)  l_vx(t)    f_x(t)  f_vx(t)    r_x(t)  r_vx(t)  HA(t)  \
0      257.388   21.404   299.889   19.763   218.186   19.078      0   
1      261.662   21.311   303.771   18.899   221.911   17.889      0   
2      265.917   21.214   307.504   18.318   225.415   16.978      0   
3      270.152   21.112   311.134   17.903   228.760   16.346      0   
4      274.367   21.009   314.690   17.594   231.993   15.899      0   
...        ...      ...       ...      ...       ...      ...    ...   
3955  1311.679   29.541  1347.168   20.091  1329.999   19.989      0   
3956  1317.622   30.040  1351.186   20.094  1333.997   19.991      0   
3957  1323.635   30.046  1355.206   20.098  1337.996   19.992      1   
3958  1329.513   28.156  1359.226   20.101  1341.994   19.994      0   
3959  1335.157   28.321  1363.246   20.105  1345.993   19.996      1   

      controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0                    -0.007947                 -0.007947   
1                    -0.004307                 -0.004307   
2                     0.002960                  0.002960   
3                    -0.004507                 -0.004507   
4                    -0.008133                 -0.008133   
...                        ...                       ...   
3955                  0.023427                  0.023427   
3956                  0.022840                  0.022840   
3957                  0.008693                  0.008693   
3958                  0.005653                  0.005653   
3959                  0.007053                  0.007053   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  \
0                      -0.0860                    0.0740   
1                      -0.0816                    0.0784   
2                      -0.0748                    0.0852   
3                      -0.0820                    0.0780   
4                      -0.0856                    0.0744   
...                        ...                       ...   
3955                   -0.0532                    0.1068   
3956                   -0.0584                    0.1016   
3957                   -0.0744                    0.0856   
3958                   -0.0776                    0.0824   
3959                   -0.0764                    0.0836   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                     1.4420                  -6.632                     0.0   
1                     1.3960                  -7.611                     0.0   
2                     1.1328                  -8.850                     0.0   
3                     1.0308                  -9.520                     0.0   
4                     1.0688                  -9.734                     0.0   
...                      ...                     ...                     ...   
3955                  0.1836                  -9.450                     0.0   
3956                 -0.0160                  -9.946                     0.0   
3957                 -0.0184                  -9.948                     0.0   
3958                  0.7376                  -8.055                     0.0   
3959                  0.6716                  -8.216                     0.0   

      controller-LA.acc-3(t)  LA.steer(t)  LA.acc(t)  
0                        0.0        0.003      3.170  
1                        0.0        0.007      3.272  
2                        0.0        0.029      5.695  
3                        0.0       -0.014      1.050  
4                        0.0       -0.012     -0.433  
...                      ...          ...        ...  
3955                     0.0       -0.030     -3.638  
3956                     0.0        0.023     -2.549  
3957                     0.0        0.011    -13.878  
3958                     0.0       -0.014      0.504  
3959                     0.0        0.012     -7.525  

[3960 rows x 38 columns]


Relevant data: Scaled and reframed as a supervised learning problem


        x(t-1)    y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     0.059221  0.309933  0.115434   0.436525  0.110914   0.715644  0.029903   
1     0.063448  0.311918  0.118670   0.431587  0.114201   0.588159  0.033154   
2     0.067730  0.313835  0.121893   0.426310  0.117315   0.494814  0.036207   
3     0.072072  0.312658  0.125101   0.420805  0.120309   0.432044  0.039079   
4     0.076507  0.313330  0.128294   0.415016  0.123221   0.387208  0.041821   
...        ...       ...       ...        ...       ...        ...       ...   
3955  0.961822  0.060581  0.909193   0.871630  0.950970   0.623163  0.941233   
3956  0.966567  0.046419  0.913602   0.893366  0.954193   0.623596  0.944509   
3957  0.971390  0.034781  0.918083   0.921684  0.957416   0.623920  0.947787   
3958  0.976269  0.030105  0.922617   0.922025  0.960640   0.624352  0.951065   
3959  0.981039  0.029702  0.927049   0.814766  0.963864   0.624676  0.954342   

      r_vx(t-1)  HA(t-1)  controller-LA.steer-0(t-1)  \
0      0.396734      0.0                    0.494067   
1      0.328683      0.0                    0.486756   
2      0.261257      0.0                    0.492822   
3      0.209595      0.0                    0.504933   
4      0.173755      0.0                    0.492489   
...         ...      ...                         ...   
3955   0.380231      0.0                    0.560358   
3956   0.380345      0.0                    0.539045   
3957   0.380458      0.0                    0.538067   
3958   0.380515      1.0                    0.514489   
3959   0.380628      0.0                    0.509422   

      controller-LA.steer-1(t-1)  controller-LA.steer-2(t-1)  \
0                       0.494067                    0.362667   
1                       0.486756                    0.356667   
2                       0.492822                    0.364000   
3                       0.504933                    0.375333   
4                       0.492489                    0.363333   
...                          ...                         ...   
3955                    0.560358                    0.442000   
3956                    0.539045                    0.411333   
3957                    0.538067                    0.402667   
3958                    0.514489                    0.376000   
3959                    0.509422                    0.370667   

      controller-LA.steer-3(t-1)  controller-LA.acc-0(t-1)  \
0                       0.629333                  0.554440   
1                       0.623333                  0.548067   
2                       0.630667                  0.546533   
3                       0.642000                  0.537760   
4                       0.630000                  0.534360   
...                          ...                       ...   
3955                    0.708667                  0.511227   
3956                    0.678000                  0.506120   
3957                    0.669333                  0.499467   
3958                    0.642667                  0.499387   
3959                    0.637333                  0.524587   

      controller-LA.acc-1(t-1)  controller-LA.acc-2(t-1)  \
0                     0.334200                       0.5   
1                     0.278933                       0.5   
2                     0.246300                       0.5   
3                     0.205000                       0.5   
4                     0.182667                       0.5   
...                        ...                       ...   
3955                  0.197633                       0.5   
3956                  0.185000                       0.5   
3957                  0.168467                       0.5   
3958                  0.168400                       0.5   
3959                  0.231500                       0.5   

      controller-LA.acc-3(t-1)  LA.steer(t-1)  LA.acc(t-1)      x(t)  \
0                          0.5       0.463333     0.495700  0.059289   
1                          0.5       0.505000     0.605667  0.063569   
2                          0.5       0.511667     0.609067  0.067908   
3                          0.5       0.548333     0.689833  0.072340   
4                          0.5       0.476667     0.535000  0.076805   
...                        ...            ...          ...       ...   
3955                       0.5       0.568333     0.469800  0.961854   
3956                       0.5       0.450000     0.378733  0.966674   
3957                       0.5       0.538333     0.415033  0.971550   
3958                       0.5       0.518333     0.037400  0.976317   
3959                       0.5       0.476667     0.516800  0.980894   

          y(t)    l_x(t)   l_vx(t)    f_x(t)   f_vx(t)    r_x(t)   r_vx(t)  \
0     0.311918  0.118290  0.431587  0.110823  0.590136  0.033042  0.328683   
1     0.313835  0.121502  0.426310  0.113937  0.496477  0.036086  0.261257   
2     0.312658  0.124700  0.420805  0.116931  0.433496  0.038948  0.209595   
3     0.313330  0.127883  0.415016  0.119843  0.388509  0.041681  0.173755   
4     0.313398  0.131051  0.409171  0.122696  0.355014  0.044322  0.148406   
...        ...       ...       ...       ...       ...       ...       ...   
3955  0.046419  0.910677  0.893366  0.950867  0.625691  0.941342  0.380345   
3956  0.034781  0.915143  0.921684  0.954090  0.626016  0.944608  0.380458   
3957  0.030105  0.919663  0.922025  0.957314  0.626450  0.947875  0.380515   
3958  0.029702  0.924080  0.814766  0.960539  0.626775  0.951141  0.380628   
3959  0.029197  0.928322  0.824130  0.963763  0.627209  0.954408  0.380742   

      HA(t)  controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0         0                  0.486756                  0.486756   
1         0                  0.492822                  0.492822   
2         0                  0.504933                  0.504933   
3         0                  0.492489                  0.492489   
4         0                  0.486445                  0.486445   
...     ...                       ...                       ...   
3955      0                  0.539045                  0.539045   
3956      0                  0.538067                  0.538067   
3957      1                  0.514489                  0.514489   
3958      0                  0.509422                  0.509422   
3959      1                  0.511755                  0.511755   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  \
0                     0.356667                  0.623333   
1                     0.364000                  0.630667   
2                     0.375333                  0.642000   
3                     0.363333                  0.630000   
4                     0.357333                  0.624000   
...                        ...                       ...   
3955                  0.411333                  0.678000   
3956                  0.402667                  0.669333   
3957                  0.376000                  0.642667   
3958                  0.370667                  0.637333   
3959                  0.372667                  0.639333   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                   0.548067                0.278933                     0.5   
1                   0.546533                0.246300                     0.5   
2                   0.537760                0.205000                     0.5   
3                   0.534360                0.182667                     0.5   
4                   0.535627                0.175533                     0.5   
...                      ...                     ...                     ...   
3955                0.506120                0.185000                     0.5   
3956                0.499467                0.168467                     0.5   
3957                0.499387                0.168400                     0.5   
3958                0.524587                0.231500                     0.5   
3959                0.522387                0.226133                     0.5   

      controller-LA.acc-3(t)  LA.steer(t)  LA.acc(t)  
0                        0.5     0.505000   0.605667  
1                        0.5     0.511667   0.609067  
2                        0.5     0.548333   0.689833  
3                        0.5     0.476667   0.535000  
4                        0.5     0.480000   0.485567  
...                      ...          ...        ...  
3955                     0.5     0.450000   0.378733  
3956                     0.5     0.538333   0.415033  
3957                     0.5     0.518333   0.037400  
3958                     0.5     0.476667   0.516800  
3959                     0.5     0.520000   0.249167  

[3960 rows x 38 columns]
        x(t-1)    y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     0.059221  0.309933  0.115434   0.436525  0.110914   0.715644  0.029903   
1     0.063448  0.311918  0.118670   0.431587  0.114201   0.588159  0.033154   
2     0.067730  0.313835  0.121893   0.426310  0.117315   0.494814  0.036207   
3     0.072072  0.312658  0.125101   0.420805  0.120309   0.432044  0.039079   
4     0.076507  0.313330  0.128294   0.415016  0.123221   0.387208  0.041821   
...        ...       ...       ...        ...       ...        ...       ...   
3955  0.961822  0.060581  0.909193   0.871630  0.950970   0.623163  0.941233   
3956  0.966567  0.046419  0.913602   0.893366  0.954193   0.623596  0.944509   
3957  0.971390  0.034781  0.918083   0.921684  0.957416   0.623920  0.947787   
3958  0.976269  0.030105  0.922617   0.922025  0.960640   0.624352  0.951065   
3959  0.981039  0.029702  0.927049   0.814766  0.963864   0.624676  0.954342   

      r_vx(t-1)  controller-LA.steer-0(t-1)  controller-LA.steer-1(t-1)  \
0      0.396734                    0.494067                    0.494067   
1      0.328683                    0.486756                    0.486756   
2      0.261257                    0.492822                    0.492822   
3      0.209595                    0.504933                    0.504933   
4      0.173755                    0.492489                    0.492489   
...         ...                         ...                         ...   
3955   0.380231                    0.560358                    0.560358   
3956   0.380345                    0.539045                    0.539045   
3957   0.380458                    0.538067                    0.538067   
3958   0.380515                    0.514489                    0.514489   
3959   0.380628                    0.509422                    0.509422   

      controller-LA.steer-2(t-1)  controller-LA.steer-3(t-1)  \
0                       0.362667                    0.629333   
1                       0.356667                    0.623333   
2                       0.364000                    0.630667   
3                       0.375333                    0.642000   
4                       0.363333                    0.630000   
...                          ...                         ...   
3955                    0.442000                    0.708667   
3956                    0.411333                    0.678000   
3957                    0.402667                    0.669333   
3958                    0.376000                    0.642667   
3959                    0.370667                    0.637333   

      controller-LA.acc-0(t-1)  controller-LA.acc-1(t-1)  \
0                     0.554440                  0.334200   
1                     0.548067                  0.278933   
2                     0.546533                  0.246300   
3                     0.537760                  0.205000   
4                     0.534360                  0.182667   
...                        ...                       ...   
3955                  0.511227                  0.197633   
3956                  0.506120                  0.185000   
3957                  0.499467                  0.168467   
3958                  0.499387                  0.168400   
3959                  0.524587                  0.231500   

      controller-LA.acc-2(t-1)  controller-LA.acc-3(t-1)  LA.steer(t-1)  \
0                          0.5                       0.5       0.463333   
1                          0.5                       0.5       0.505000   
2                          0.5                       0.5       0.511667   
3                          0.5                       0.5       0.548333   
4                          0.5                       0.5       0.476667   
...                        ...                       ...            ...   
3955                       0.5                       0.5       0.568333   
3956                       0.5                       0.5       0.450000   
3957                       0.5                       0.5       0.538333   
3958                       0.5                       0.5       0.518333   
3959                       0.5                       0.5       0.476667   

      LA.acc(t-1)      x(t)      y(t)    l_x(t)   l_vx(t)    f_x(t)   f_vx(t)  \
0        0.495700  0.059289  0.311918  0.118290  0.431587  0.110823  0.590136   
1        0.605667  0.063569  0.313835  0.121502  0.426310  0.113937  0.496477   
2        0.609067  0.067908  0.312658  0.124700  0.420805  0.116931  0.433496   
3        0.689833  0.072340  0.313330  0.127883  0.415016  0.119843  0.388509   
4        0.535000  0.076805  0.313398  0.131051  0.409171  0.122696  0.355014   
...           ...       ...       ...       ...       ...       ...       ...   
3955     0.469800  0.961854  0.046419  0.910677  0.893366  0.950867  0.625691   
3956     0.378733  0.966674  0.034781  0.915143  0.921684  0.954090  0.626016   
3957     0.415033  0.971550  0.030105  0.919663  0.922025  0.957314  0.626450   
3958     0.037400  0.976317  0.029702  0.924080  0.814766  0.960539  0.626775   
3959     0.516800  0.980894  0.029197  0.928322  0.824130  0.963763  0.627209   

        r_x(t)   r_vx(t)  
0     0.033042  0.328683  
1     0.036086  0.261257  
2     0.038948  0.209595  
3     0.041681  0.173755  
4     0.044322  0.148406  
...        ...       ...  
3955  0.941342  0.380345  
3956  0.944608  0.380458  
3957  0.947875  0.380515  
3958  0.951141  0.380628  
3959  0.954408  0.380742  

[3960 rows x 26 columns]
      LA.steer(t)  controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0        0.505000                  0.486756                  0.486756   
1        0.511667                  0.492822                  0.492822   
2        0.548333                  0.504933                  0.504933   
3        0.476667                  0.492489                  0.492489   
4        0.480000                  0.486445                  0.486445   
...           ...                       ...                       ...   
3955     0.450000                  0.539045                  0.539045   
3956     0.538333                  0.538067                  0.538067   
3957     0.518333                  0.514489                  0.514489   
3958     0.476667                  0.509422                  0.509422   
3959     0.520000                  0.511755                  0.511755   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  LA.acc(t)  \
0                     0.356667                  0.623333   0.605667   
1                     0.364000                  0.630667   0.609067   
2                     0.375333                  0.642000   0.689833   
3                     0.363333                  0.630000   0.535000   
4                     0.357333                  0.624000   0.485567   
...                        ...                       ...        ...   
3955                  0.411333                  0.678000   0.378733   
3956                  0.402667                  0.669333   0.415033   
3957                  0.376000                  0.642667   0.037400   
3958                  0.370667                  0.637333   0.516800   
3959                  0.372667                  0.639333   0.249167   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                   0.548067                0.278933                     0.5   
1                   0.546533                0.246300                     0.5   
2                   0.537760                0.205000                     0.5   
3                   0.534360                0.182667                     0.5   
4                   0.535627                0.175533                     0.5   
...                      ...                     ...                     ...   
3955                0.506120                0.185000                     0.5   
3956                0.499467                0.168467                     0.5   
3957                0.499387                0.168400                     0.5   
3958                0.524587                0.231500                     0.5   
3959                0.522387                0.226133                     0.5   

      controller-LA.acc-3(t)  
0                        0.5  
1                        0.5  
2                        0.5  
3                        0.5  
4                        0.5  
...                      ...  
3955                     0.5  
3956                     0.5  
3957                     0.5  
3958                     0.5  
3959                     0.5  

[3960 rows x 10 columns]
Training set size
832
Test set size
356
Validation set size
3960
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 128)               79360     
                                                                 
 dense (Dense)               (None, 64)                8256      
                                                                 
 dense_1 (Dense)             (None, 16)                1040      
                                                                 
 dense_2 (Dense)             (None, 4)                 68        
                                                                 
 dense_3 (Dense)             (None, 4)                 20        
                                                                 
=================================================================
Total params: 88,744
Trainable params: 88,744
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1585: early stopping
 1/38 [..............................] - ETA: 15s38/38 [==============================] - 0s 935us/step
  1/124 [..............................] - ETA: 1s 56/124 [============>.................] - ETA: 0s114/124 [==========================>...] - ETA: 0s124/124 [==============================] - 0s 890us/step
######## Metrics: Weighted by softmax ########
Testing set percent accuracy: 16.4983164983165%
Testing set cumulative log obs: -185054.14048474218
Validation set percent accuracy: 13.939393939393941%
Validation set cumulative log obs: -676239.317999516

