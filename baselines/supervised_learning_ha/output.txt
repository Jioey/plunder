Relevant data:
       x(t-1)  y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     186.334   0.197   186.334     24.108   291.105     21.517   248.480   
1     189.314   0.472   189.314     23.426   293.780     21.182   251.187   
2     192.216   0.895   192.216     23.163   296.416     20.891   253.880   
3     195.077   1.384   195.077     22.594   299.016     20.637   256.562   
4     197.904   1.902   197.904     22.799   301.586     20.413   259.232   
...       ...     ...       ...        ...       ...        ...       ...   
2185  439.897   4.170   494.943     19.535   450.827     16.814   439.897   
2186  442.128   4.187   497.385     19.529   452.928     16.795   442.128   
2187  444.331   4.168   499.826     19.523   455.027     16.777   444.331   
2188  446.465   4.147   502.266     19.517   457.123     16.760   446.465   
2189  448.585   4.132   504.705     19.511   459.218     16.745   448.585   

      r_vx(t-1)  HA(t-1)  controller-LA.steer-0(t-1)  \
0        21.695      3.0                    0.010000   
1        21.584      3.0                   -0.028000   
2        21.483      3.0                    0.003000   
3        21.391      3.0                   -0.031000   
4        21.307      3.0                   -0.055000   
...         ...      ...                         ...   
2185     17.834      1.0                   -0.001667   
2186     17.872      1.0                   -0.010233   
2187     17.122      1.0                   -0.001600   
2188     16.991      1.0                    0.003100   
2189     16.887      1.0                    0.003600   

      controller-LA.steer-1(t-1)  controller-LA.steer-2(t-1)  \
0                       0.010000                       0.010   
1                      -0.028000                      -0.028   
2                       0.003000                       0.003   
3                      -0.031000                      -0.031   
4                      -0.055000                      -0.055   
...                          ...                         ...   
2185                   -0.001667                      -0.112   
2186                   -0.010233                      -0.061   
2187                   -0.001600                      -0.099   
2188                    0.003100                      -0.089   
2189                    0.003600                      -0.078   

      controller-LA.steer-3(t-1)  controller-LA.acc-0(t-1)  \
0                          0.094                    -2.835   
1                          0.063                    -1.047   
2                          0.014                     2.908   
3                         -0.014                     0.183   
4                         -0.028                     6.118   
...                          ...                       ...   
2185                       0.048                    11.969   
2186                       0.099                     4.304   
2187                       0.061                    -2.004   
2188                       0.071                     2.960   
2189                       0.082                     3.165   

      controller-LA.acc-1(t-1)  controller-LA.acc-2(t-1)  \
0                       -2.835                    -2.835   
1                       -2.244                    -1.047   
2                       -2.272                    -0.500   
3                       -1.957                    -0.500   
4                       -2.386                    -0.500   
...                        ...                       ...   
2185                     1.969                     1.969   
2186                    -1.077                    -0.500   
2187                    -2.004                    -2.004   
2188                    -0.231                    -0.500   
2189                    -0.142                    -0.500   

      controller-LA.acc-3(t-1)  LA.steer(t-1)  LA.acc(t-1)     x(t)   y(t)  \
0                       -2.835          0.052       -5.047  189.314  0.472   
1                       -1.047          0.083       -1.092  192.216  0.895   
2                       -0.500          0.049       -3.817  195.077  1.384   
3                       -0.500          0.025        2.118  197.904  1.902   
4                       -0.500         -0.078       -2.130  200.766  2.258   
...                        ...            ...          ...      ...    ...   
2185                     1.969          0.019        0.304  442.128  4.187   
2186                    -0.500         -0.019       -6.004  444.331  4.168   
2187                    -2.004         -0.009       -1.040  446.465  4.147   
2188                    -0.500          0.002       -0.835  448.585  4.132   
2189                    -0.500          0.008       -1.931  450.686  4.126   

       l_x(t)  l_vx(t)   f_x(t)  f_vx(t)   r_x(t)  r_vx(t)  HA(t)  \
0     189.314   23.426  293.780   21.182  251.187   21.584      3   
1     192.216   23.163  296.416   20.891  253.880   21.483      3   
2     195.077   22.594  299.016   20.637  256.562   21.391      3   
3     197.904   22.799  301.586   20.413  259.232   21.307      3   
4     304.129   20.216  261.892   21.231  222.753   23.556      3   
...       ...      ...      ...      ...      ...      ...    ...   
2185  497.385   19.529  452.928   16.795  442.128   17.872      1   
2186  499.826   19.523  455.027   16.777  444.331   17.122      1   
2187  502.266   19.517  457.123   16.760  446.465   16.991      1   
2188  504.705   19.511  459.218   16.745  448.585   16.887      1   
2189  507.144   19.505  461.310   16.732  450.686   16.646      1   

      controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0                    -0.028000                 -0.028000   
1                     0.003000                  0.003000   
2                    -0.031000                 -0.031000   
3                    -0.055000                 -0.055000   
4                    -0.074998                 -0.074998   
...                        ...                       ...   
2185                 -0.010233                 -0.010233   
2186                 -0.001600                 -0.001600   
2187                  0.003100                  0.003100   
2188                  0.003600                  0.003600   
2189                 -0.000200                 -0.000200   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  \
0                       -0.028                     0.063   
1                        0.003                     0.014   
2                       -0.031                    -0.014   
3                       -0.055                    -0.028   
4                       -0.158                     0.002   
...                        ...                       ...   
2185                    -0.061                     0.099   
2186                    -0.099                     0.061   
2187                    -0.089                     0.071   
2188                    -0.078                     0.082   
2189                    -0.072                     0.088   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                     -1.047                  -2.244                  -1.047   
1                      2.908                  -2.272                  -0.500   
2                      0.183                  -1.957                  -0.500   
3                      6.118                  -2.386                  -0.500   
4                      1.870                  -1.466                  -0.500   
...                      ...                     ...                     ...   
2185                   4.304                  -1.077                  -0.500   
2186                  -2.004                  -2.004                  -2.004   
2187                   2.960                  -0.231                  -0.500   
2188                   3.165                  -0.142                  -0.500   
2189                   2.069                   0.086                  -0.500   

      controller-LA.acc-3(t)  LA.steer(t)  LA.acc(t)  
0                     -1.047        0.083     -1.092  
1                     -0.500        0.049     -3.817  
2                     -0.500        0.025      2.118  
3                     -0.500       -0.078     -2.130  
4                     -0.500        0.039      3.388  
...                      ...          ...        ...  
2185                  -0.500       -0.019     -6.004  
2186                  -2.004       -0.009     -1.040  
2187                  -0.500        0.002     -0.835  
2188                  -0.500        0.008     -1.931  
2189                  -0.500        0.005      3.653  

[2190 rows x 38 columns]


Relevant data: Scaled and reframed as a supervised learning problem


        x(t-1)    y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     0.115933  0.065019  0.193743   0.354970  0.411049   0.609836  0.367397   
1     0.124223  0.077966  0.200430   0.327677  0.416803   0.600201  0.374096   
2     0.132296  0.097881  0.206942   0.317152  0.422473   0.591832  0.380759   
3     0.140255  0.120904  0.213363   0.294381  0.428065   0.584527  0.387395   
4     0.148119  0.145292  0.219707   0.302585  0.433593   0.578085  0.394002   
...        ...       ...       ...        ...       ...        ...       ...   
2185  0.821290  0.252072  0.886293   0.171963  0.754596   0.474576  0.841038   
2186  0.827496  0.252872  0.891774   0.171722  0.759116   0.474029  0.846558   
2187  0.833624  0.251977  0.897251   0.171482  0.763630   0.473512  0.852009   
2188  0.839561  0.250989  0.902727   0.171242  0.768139   0.473023  0.857290   
2189  0.845458  0.250282  0.908200   0.171002  0.772645   0.472591  0.862535   

      r_vx(t-1)  HA(t-1)  controller-LA.steer-0(t-1)  \
0      0.533175      3.0                    0.516667   
1      0.530405      3.0                    0.453333   
2      0.527885      3.0                    0.505000   
3      0.525590      3.0                    0.448333   
4      0.523493      3.0                    0.408333   
...         ...      ...                         ...   
2185   0.436831      1.0                    0.497222   
2186   0.437779      1.0                    0.482945   
2187   0.419064      1.0                    0.497333   
2188   0.415795      1.0                    0.505167   
2189   0.413200      1.0                    0.506000   

      controller-LA.steer-1(t-1)  controller-LA.steer-2(t-1)  \
0                       0.516667                    0.516667   
1                       0.453333                    0.453333   
2                       0.505000                    0.505000   
3                       0.448333                    0.448333   
4                       0.408333                    0.408333   
...                          ...                         ...   
2185                    0.497222                    0.313333   
2186                    0.482945                    0.398333   
2187                    0.497333                    0.335000   
2188                    0.505167                    0.351667   
2189                    0.506000                    0.370000   

      controller-LA.steer-3(t-1)  controller-LA.acc-0(t-1)  \
0                       0.656667                   0.44330   
1                       0.605000                   0.47906   
2                       0.523333                   0.55816   
3                       0.476667                   0.50366   
4                       0.453333                   0.62236   
...                          ...                       ...   
2185                    0.580000                   0.73938   
2186                    0.665000                   0.58608   
2187                    0.601667                   0.45992   
2188                    0.618333                   0.55920   
2189                    0.636667                   0.56330   

      controller-LA.acc-1(t-1)  controller-LA.acc-2(t-1)  \
0                      0.44330                   0.44330   
1                      0.45512                   0.47906   
2                      0.45456                   0.49000   
3                      0.46086                   0.49000   
4                      0.45228                   0.49000   
...                        ...                       ...   
2185                   0.53938                   0.53938   
2186                   0.47846                   0.49000   
2187                   0.45992                   0.45992   
2188                   0.49538                   0.49000   
2189                   0.49716                   0.49000   

      controller-LA.acc-3(t-1)  LA.steer(t-1)  LA.acc(t-1)      x(t)  \
0                      0.44330       0.586667      0.39906  0.116370   
1                      0.47906       0.638333      0.47816  0.124440   
2                      0.49000       0.581667      0.42366  0.132395   
3                      0.49000       0.541667      0.54236  0.140256   
4                      0.49000       0.370000      0.45740  0.148214   
...                        ...            ...          ...       ...   
2185                   0.53938       0.531667      0.50608  0.819342   
2186                   0.49000       0.468333      0.37992  0.825468   
2187                   0.45992       0.485000      0.47920  0.831402   
2188                   0.49000       0.503333      0.48330  0.837297   
2189                   0.49000       0.513333      0.46138  0.843139   

          y(t)    l_x(t)   l_vx(t)    f_x(t)   f_vx(t)    r_x(t)   r_vx(t)  \
0     0.076394  0.199190  0.327677  0.414436  0.600638  0.371376  0.530862   
1     0.095908  0.205662  0.317152  0.420074  0.592278  0.377992  0.528344   
2     0.118467  0.212043  0.294381  0.425634  0.584980  0.384580  0.526051   
3     0.142363  0.218348  0.302585  0.431131  0.578545  0.391138  0.523957   
4     0.158786  0.455253  0.199216  0.346238  0.602046  0.301531  0.580022   
...        ...       ...       ...       ...       ...       ...       ...   
2185  0.247774  0.886256  0.171722  0.754805  0.474604  0.840405  0.438326   
2186  0.246898  0.891700  0.171482  0.759294  0.474086  0.845816  0.419629   
2187  0.245929  0.897142  0.171242  0.763777  0.473598  0.851058  0.416363   
2188  0.245237  0.902582  0.171002  0.768257  0.473167  0.856266  0.413771   
2189  0.244960  0.908021  0.170762  0.772732  0.472794  0.861427  0.407763   

      HA(t)  controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0         3                  0.453333                  0.453333   
1         3                  0.505000                  0.505000   
2         3                  0.448333                  0.448333   
3         3                  0.408333                  0.408333   
4         3                  0.375003                  0.375003   
...     ...                       ...                       ...   
2185      1                  0.482945                  0.482945   
2186      1                  0.497333                  0.497333   
2187      1                  0.505167                  0.505167   
2188      1                  0.506000                  0.506000   
2189      1                  0.499667                  0.499667   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  \
0                     0.453333                  0.605000   
1                     0.505000                  0.523333   
2                     0.448333                  0.476667   
3                     0.408333                  0.453333   
4                     0.236667                  0.503333   
...                        ...                       ...   
2185                  0.398333                  0.665000   
2186                  0.335000                  0.601667   
2187                  0.351667                  0.618333   
2188                  0.370000                  0.636667   
2189                  0.380000                  0.646667   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                    0.47906                 0.45512                 0.47906   
1                    0.55816                 0.45456                 0.49000   
2                    0.50366                 0.46086                 0.49000   
3                    0.62236                 0.45228                 0.49000   
4                    0.53740                 0.47068                 0.49000   
...                      ...                     ...                     ...   
2185                 0.58608                 0.47846                 0.49000   
2186                 0.45992                 0.45992                 0.45992   
2187                 0.55920                 0.49538                 0.49000   
2188                 0.56330                 0.49716                 0.49000   
2189                 0.54138                 0.50172                 0.49000   

      controller-LA.acc-3(t)  LA.steer(t)  LA.acc(t)  
0                    0.47906     0.638333    0.47816  
1                    0.49000     0.581667    0.42366  
2                    0.49000     0.541667    0.54236  
3                    0.49000     0.370000    0.45740  
4                    0.49000     0.565000    0.56776  
...                      ...          ...        ...  
2185                 0.49000     0.468333    0.37992  
2186                 0.45992     0.485000    0.47920  
2187                 0.49000     0.503333    0.48330  
2188                 0.49000     0.513333    0.46138  
2189                 0.49000     0.508333    0.57306  

[2190 rows x 38 columns]
        x(t-1)    y(t-1)  l_x(t-1)  l_vx(t-1)  f_x(t-1)  f_vx(t-1)  r_x(t-1)  \
0     0.115933  0.065019  0.193743   0.354970  0.411049   0.609836  0.367397   
1     0.124223  0.077966  0.200430   0.327677  0.416803   0.600201  0.374096   
2     0.132296  0.097881  0.206942   0.317152  0.422473   0.591832  0.380759   
3     0.140255  0.120904  0.213363   0.294381  0.428065   0.584527  0.387395   
4     0.148119  0.145292  0.219707   0.302585  0.433593   0.578085  0.394002   
...        ...       ...       ...        ...       ...        ...       ...   
2185  0.821290  0.252072  0.886293   0.171963  0.754596   0.474576  0.841038   
2186  0.827496  0.252872  0.891774   0.171722  0.759116   0.474029  0.846558   
2187  0.833624  0.251977  0.897251   0.171482  0.763630   0.473512  0.852009   
2188  0.839561  0.250989  0.902727   0.171242  0.768139   0.473023  0.857290   
2189  0.845458  0.250282  0.908200   0.171002  0.772645   0.472591  0.862535   

      r_vx(t-1)  controller-LA.steer-0(t-1)  controller-LA.steer-1(t-1)  \
0      0.533175                    0.516667                    0.516667   
1      0.530405                    0.453333                    0.453333   
2      0.527885                    0.505000                    0.505000   
3      0.525590                    0.448333                    0.448333   
4      0.523493                    0.408333                    0.408333   
...         ...                         ...                         ...   
2185   0.436831                    0.497222                    0.497222   
2186   0.437779                    0.482945                    0.482945   
2187   0.419064                    0.497333                    0.497333   
2188   0.415795                    0.505167                    0.505167   
2189   0.413200                    0.506000                    0.506000   

      controller-LA.steer-2(t-1)  controller-LA.steer-3(t-1)  \
0                       0.516667                    0.656667   
1                       0.453333                    0.605000   
2                       0.505000                    0.523333   
3                       0.448333                    0.476667   
4                       0.408333                    0.453333   
...                          ...                         ...   
2185                    0.313333                    0.580000   
2186                    0.398333                    0.665000   
2187                    0.335000                    0.601667   
2188                    0.351667                    0.618333   
2189                    0.370000                    0.636667   

      controller-LA.acc-0(t-1)  controller-LA.acc-1(t-1)  \
0                      0.44330                   0.44330   
1                      0.47906                   0.45512   
2                      0.55816                   0.45456   
3                      0.50366                   0.46086   
4                      0.62236                   0.45228   
...                        ...                       ...   
2185                   0.73938                   0.53938   
2186                   0.58608                   0.47846   
2187                   0.45992                   0.45992   
2188                   0.55920                   0.49538   
2189                   0.56330                   0.49716   

      controller-LA.acc-2(t-1)  controller-LA.acc-3(t-1)  LA.steer(t-1)  \
0                      0.44330                   0.44330       0.586667   
1                      0.47906                   0.47906       0.638333   
2                      0.49000                   0.49000       0.581667   
3                      0.49000                   0.49000       0.541667   
4                      0.49000                   0.49000       0.370000   
...                        ...                       ...            ...   
2185                   0.53938                   0.53938       0.531667   
2186                   0.49000                   0.49000       0.468333   
2187                   0.45992                   0.45992       0.485000   
2188                   0.49000                   0.49000       0.503333   
2189                   0.49000                   0.49000       0.513333   

      LA.acc(t-1)      x(t)      y(t)    l_x(t)   l_vx(t)    f_x(t)   f_vx(t)  \
0         0.39906  0.116370  0.076394  0.199190  0.327677  0.414436  0.600638   
1         0.47816  0.124440  0.095908  0.205662  0.317152  0.420074  0.592278   
2         0.42366  0.132395  0.118467  0.212043  0.294381  0.425634  0.584980   
3         0.54236  0.140256  0.142363  0.218348  0.302585  0.431131  0.578545   
4         0.45740  0.148214  0.158786  0.455253  0.199216  0.346238  0.602046   
...           ...       ...       ...       ...       ...       ...       ...   
2185      0.50608  0.819342  0.247774  0.886256  0.171722  0.754805  0.474604   
2186      0.37992  0.825468  0.246898  0.891700  0.171482  0.759294  0.474086   
2187      0.47920  0.831402  0.245929  0.897142  0.171242  0.763777  0.473598   
2188      0.48330  0.837297  0.245237  0.902582  0.171002  0.768257  0.473167   
2189      0.46138  0.843139  0.244960  0.908021  0.170762  0.772732  0.472794   

        r_x(t)   r_vx(t)  
0     0.371376  0.530862  
1     0.377992  0.528344  
2     0.384580  0.526051  
3     0.391138  0.523957  
4     0.301531  0.580022  
...        ...       ...  
2185  0.840405  0.438326  
2186  0.845816  0.419629  
2187  0.851058  0.416363  
2188  0.856266  0.413771  
2189  0.861427  0.407763  

[2190 rows x 26 columns]
      LA.steer(t)  controller-LA.steer-0(t)  controller-LA.steer-1(t)  \
0        0.638333                  0.453333                  0.453333   
1        0.581667                  0.505000                  0.505000   
2        0.541667                  0.448333                  0.448333   
3        0.370000                  0.408333                  0.408333   
4        0.565000                  0.375003                  0.375003   
...           ...                       ...                       ...   
2185     0.468333                  0.482945                  0.482945   
2186     0.485000                  0.497333                  0.497333   
2187     0.503333                  0.505167                  0.505167   
2188     0.513333                  0.506000                  0.506000   
2189     0.508333                  0.499667                  0.499667   

      controller-LA.steer-2(t)  controller-LA.steer-3(t)  LA.acc(t)  \
0                     0.453333                  0.605000    0.47816   
1                     0.505000                  0.523333    0.42366   
2                     0.448333                  0.476667    0.54236   
3                     0.408333                  0.453333    0.45740   
4                     0.236667                  0.503333    0.56776   
...                        ...                       ...        ...   
2185                  0.398333                  0.665000    0.37992   
2186                  0.335000                  0.601667    0.47920   
2187                  0.351667                  0.618333    0.48330   
2188                  0.370000                  0.636667    0.46138   
2189                  0.380000                  0.646667    0.57306   

      controller-LA.acc-0(t)  controller-LA.acc-1(t)  controller-LA.acc-2(t)  \
0                    0.47906                 0.45512                 0.47906   
1                    0.55816                 0.45456                 0.49000   
2                    0.50366                 0.46086                 0.49000   
3                    0.62236                 0.45228                 0.49000   
4                    0.53740                 0.47068                 0.49000   
...                      ...                     ...                     ...   
2185                 0.58608                 0.47846                 0.49000   
2186                 0.45992                 0.45992                 0.45992   
2187                 0.55920                 0.49538                 0.49000   
2188                 0.56330                 0.49716                 0.49000   
2189                 0.54138                 0.50172                 0.49000   

      controller-LA.acc-3(t)  
0                    0.47906  
1                    0.49000  
2                    0.49000  
3                    0.49000  
4                    0.49000  
...                      ...  
2185                 0.49000  
2186                 0.45992  
2187                 0.49000  
2188                 0.49000  
2189                 0.49000  

[2190 rows x 10 columns]
Training set size
511
Test set size
219
Validation set size
2190
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 128)               79360     
                                                                 
 dense (Dense)               (None, 64)                8256      
                                                                 
 dense_1 (Dense)             (None, 16)                1040      
                                                                 
 dense_2 (Dense)             (None, 4)                 68        
                                                                 
 dense_3 (Dense)             (None, 4)                 20        
                                                                 
=================================================================
Total params: 88,744
Trainable params: 88,744
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1146: early stopping
 1/23 [>.............................] - ETA: 12s23/23 [==============================] - 1s 1ms/step
 1/69 [..............................] - ETA: 1s56/69 [=======================>......] - ETA: 0s69/69 [==============================] - 0s 916us/step
######## Metrics: Weighted by softmax ########
Testing set percent accuracy: 87.07387171791346%
Testing set cumulative log obs: -1.1245363818828098
Validation set percent accuracy: 78.92836106034765%
Validation set cumulative log obs: -1.9674041108413243

